/**
 * Node.js module for Forge.
 *
 * @author Dave Longley
 *
 * Copyright 2011-2014 Digital Bazaar, Inc.
 */
function initForge(){var t,e,r;return function(i){function n(t,e){return E.call(t,e)}function a(t,e){var r,i,n,a,s,o,u,c,l,f,p,h=e&&e.split("/"),d=v.map,y=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(h=h.slice(0,h.length-1),t=t.split("/"),s=t.length-1,v.nodeIdCompat&&T.test(t[s])&&(t[s]=t[s].replace(T,"")),t=h.concat(t),l=0;l<t.length;l+=1)if(p=t[l],"."===p)t.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||y)&&d){for(r=t.split("/"),l=r.length;l>0;l-=1){if(i=r.slice(0,l).join("/"),h)for(f=h.length;f>0;f-=1)if(n=d[h.slice(0,f).join("/")],n&&(n=n[i])){a=n,o=l;break}if(a)break;!u&&y&&y[i]&&(u=y[i],c=l)}!a&&u&&(a=u,o=c),a&&(r.splice(0,o,a),t=r.join("/"))}return t}function s(t,e){return function(){return h.apply(i,S.call(arguments,0).concat([t,e]))}}function o(t){return function(e){return a(e,t)}}function u(t){return function(e){g[t]=e}}function c(t){if(n(m,t)){var e=m[t];delete m[t],C[t]=!0,p.apply(i,e)}if(!n(g,t)&&!n(C,t))throw new Error("No "+t);return g[t]}function l(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function f(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,h,d,y,g={},m={},v={},C={},E=Object.prototype.hasOwnProperty,S=[].slice,T=/\.js$/;d=function(t,e){var r,i=l(t),n=i[0];return t=i[1],n&&(n=a(n,e),r=c(n)),n?t=r&&r.normalize?r.normalize(t,o(e)):a(t,e):(t=a(t,e),i=l(t),n=i[0],t=i[1],n&&(r=c(n))),{f:n?n+"!"+t:t,n:t,pr:n,p:r}},y={require:function(t){return s(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},p=function(t,e,r,a){var o,l,f,p,h,v,E=[],S=typeof r;if(a=a||t,"undefined"===S||"function"===S){for(e=!e.length&&r.length?["require","exports","module"]:e,h=0;h<e.length;h+=1)if(p=d(e[h],a),l=p.f,"require"===l)E[h]=y.require(t);else if("exports"===l)E[h]=y.exports(t),v=!0;else if("module"===l)o=E[h]=y.module(t);else if(n(g,l)||n(m,l)||n(C,l))E[h]=c(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,s(a,!0),u(l),{}),E[h]=g[l]}f=r?r.apply(g[t],E):void 0,t&&(o&&o.exports!==i&&o.exports!==g[t]?g[t]=o.exports:f===i&&v||(g[t]=f))}else t&&(g[t]=r)},t=e=h=function(t,e,r,n,a){if("string"==typeof t)return y[t]?y[t](e):c(d(t,e).f);if(!t.splice){if(v=t,v.deps&&h(v.deps,v.callback),!e)return;e.splice?(t=e,e=r,r=null):t=i}return e=e||function(){},"function"==typeof r&&(r=n,n=a),n?p(i,t,e,r):setTimeout(function(){p(i,t,e,r)},4),h},h.config=function(t){return h(t)},t._defined=g,r=function(t,e,r){e.splice||(r=e,e=[]),n(g,t)||n(m,t)||(m[t]=[t,e,r])},r.amd={jQuery:!0}}(),function(){function t(t){function e(t){if(this.data="",this.read=0,"string"==typeof t)this.data=t;else if(i.isArrayBuffer(t)||i.isArrayBufferView(t)){var r=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,r)}catch(n){for(var a=0;a<r.length;++a)this.putByte(r[a])}}else(t instanceof e||"object"==typeof t&&"string"==typeof t.data&&"number"==typeof t.read)&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}function r(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=i.isArrayBuffer(t),n=i.isArrayBufferView(t);return r||n?(r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),void(this.write="writeOffset"in e?e.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==t&&void 0!==t&&this.putBytes(t),void("writeOffset"in e&&(this.write=e.writeOffset)))}var i=t.util=t.util||{};!function(){function t(t){if(t.source===window&&t.data===e){t.stopPropagation();var i=r.slice();r.length=0,i.forEach(function(t){t()})}}if("undefined"!=typeof process&&process.nextTick)return i.nextTick=process.nextTick,void("function"==typeof setImmediate?i.setImmediate=setImmediate:i.setImmediate=i.nextTick);if("function"==typeof setImmediate)return i.setImmediate=setImmediate,void(i.nextTick=function(t){return setImmediate(t)});if(i.setImmediate=function(t){setTimeout(t,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",r=[];i.setImmediate=function(t){r.push(t),1===r.length&&window.postMessage(e,"*")},window.addEventListener("message",t,!0)}if("undefined"!=typeof MutationObserver){var n=Date.now(),a=!0,s=document.createElement("div"),r=[];new MutationObserver(function(){var t=r.slice();r.length=0,t.forEach(function(t){t()})}).observe(s,{attributes:!0});var o=i.setImmediate;i.setImmediate=function(t){Date.now()-n>15?(n=Date.now(),o(t)):(r.push(t),1===r.length&&s.setAttribute("a",a=!a))}}i.nextTick=i.setImmediate}(),i.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer},i.isArrayBufferView=function(t){return t&&i.isArrayBuffer(t.buffer)&&void 0!==t.byteLength},i.ByteBuffer=e,i.ByteStringBuffer=e;var n=4096;i.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>n&&(this.data.substr(0,1),this._constructedStringLength=0)},i.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},i.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))},i.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)1&e&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this},i.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this},i.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(i.encodeUtf8(t))},i.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},i.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},i.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},i.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255))},i.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))},i.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))},i.ByteStringBuffer.prototype.putInt=function(t,e){var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)},i.ByteStringBuffer.prototype.putSignedInt=function(t,e){return 0>t&&(t+=2<<e-1),this.putInt(t,e)},i.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())},i.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},i.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},i.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},i.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},i.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},i.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},i.ByteStringBuffer.prototype.getInt=function(t){var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e},i.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e},i.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},i.ByteStringBuffer.prototype.bytes=function(t){return"undefined"==typeof t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},i.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},i.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this},i.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteStringBuffer.prototype.copy=function(){var t=i.createBuffer(this.data);return t.read=this.read,t},i.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},i.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},i.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this},i.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);16>r&&(t+="0"),t+=r.toString(16)}return t},i.ByteStringBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())},i.DataBuffer=r,i.DataBuffer.prototype.length=function(){return this.write-this.read},i.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},i.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this},i.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this},i.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;e>r;++r)this.data.setUint8(t);return this},i.DataBuffer.prototype.putBytes=function(t,e){if(i.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var a=new Uint8Array(this.data.buffer,this.write);return a.set(r),this.write+=n,this}if(i.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var a=new Uint8Array(this.data.buffer);return a.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof i.DataBuffer||"object"==typeof t&&"number"==typeof t.read&&"number"==typeof t.write&&i.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var a=new Uint8Array(t.data.byteLength,this.write);return a.set(r),this.write+=r.byteLength,this}if(t instanceof i.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary","string"==typeof t){var s;if("hex"===e)return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.hex.decode(t,s,this.write),this;if("base64"===e)return this.accommodate(3*Math.ceil(t.length/4)),s=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.base64.decode(t,s,this.write),this;if("utf8"===e&&(t=i.encodeUtf8(t),e="binary"),"binary"===e||"raw"===e)return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.raw.decode(s),this;if("utf16"===e)return this.accommodate(2*t.length),s=new Uint16Array(this.data.buffer,this.write),this.write+=i.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)},i.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this},i.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")},i.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this},i.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this},i.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this},i.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this},i.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this},i.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this},i.DataBuffer.prototype.putInt=function(t,e){this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this},i.DataBuffer.prototype.putSignedInt=function(t,e){return this.accommodate(e/8),0>t&&(t+=2<<e-1),this.putInt(t,e)},i.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},i.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t},i.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t},i.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t},i.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t},i.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t},i.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t},i.DataBuffer.prototype.getInt=function(t){var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e},i.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e},i.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},i.DataBuffer.prototype.bytes=function(t){return"undefined"==typeof t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},i.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)},i.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this},i.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},i.DataBuffer.prototype.copy=function(){return new i.DataBuffer(this)},i.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this},i.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},i.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this},i.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);16>r&&(t+="0"),t+=r.toString(16)}return t},i.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8","binary"===t||"raw"===t)return i.binary.raw.encode(e);if("hex"===t)return i.binary.hex.encode(e);if("base64"===t)return i.binary.base64.encode(e);if("utf8"===t)return i.text.utf8.decode(e);if("utf16"===t)return i.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)},i.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=i.encodeUtf8(t)),new i.ByteBuffer(t)},i.fillString=function(t,e){for(var r="";e>0;)1&e&&(r+=t),e>>>=1,e>0&&(t+=t);return r},i.xorBytes=function(t,e,r){for(var i="",n="",a="",s=0,o=0;r>0;--r,++s)n=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(i+=a,a="",o=0),a+=String.fromCharCode(n),++o;return i+=a},i.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e},i.bytesToHex=function(t){return i.createBuffer(t).toHex()},i.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];i.encode64=function(t,e){for(var r,i,n,s="",o="",u=0;u<t.length;)r=t.charCodeAt(u++),i=t.charCodeAt(u++),n=t.charCodeAt(u++),s+=a.charAt(r>>2),s+=a.charAt((3&r)<<4|i>>4),isNaN(i)?s+="==":(s+=a.charAt((15&i)<<2|n>>6),s+=isNaN(n)?"=":a.charAt(63&n)),e&&s.length>e&&(o+=s.substr(0,e)+"\r\n",s=s.substr(e));return o+=s},i.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e,r,i,n,a="",o=0;o<t.length;)e=s[t.charCodeAt(o++)-43],r=s[t.charCodeAt(o++)-43],i=s[t.charCodeAt(o++)-43],n=s[t.charCodeAt(o++)-43],a+=String.fromCharCode(e<<2|r>>4),64!==i&&(a+=String.fromCharCode((15&r)<<4|i>>2),64!==n&&(a+=String.fromCharCode((3&i)<<6|n)));return a},i.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},i.decodeUtf8=function(t){return decodeURIComponent(escape(t))},i.binary={raw:{},hex:{},base64:{}},i.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)},i.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,a=0;a<t.length;++a)i[n++]=t.charCodeAt(a);return e?n-r:i},i.binary.hex.encode=i.bytesToHex,i.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,a=r;for(1&t.length&&(n=1,i[a++]=parseInt(t[0],16));n<t.length;n+=2)i[a++]=parseInt(t.substr(n,2),16);return e?a-r:i},i.binary.base64.encode=function(t,e){for(var r,i,n,s="",o="",u=0;u<t.byteLength;)r=t[u++],i=t[u++],n=t[u++],s+=a.charAt(r>>2),s+=a.charAt((3&r)<<4|i>>4),isNaN(i)?s+="==":(s+=a.charAt((15&i)<<2|n>>6),s+=isNaN(n)?"=":a.charAt(63&n)),e&&s.length>e&&(o+=s.substr(0,e)+"\r\n",s=s.substr(e));return o+=s},i.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(3*Math.ceil(t.length/4))),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,a,o,u,c=0,l=r;c<t.length;)n=s[t.charCodeAt(c++)-43],a=s[t.charCodeAt(c++)-43],o=s[t.charCodeAt(c++)-43],u=s[t.charCodeAt(c++)-43],i[l++]=n<<2|a>>4,64!==o&&(i[l++]=(15&a)<<4|o>>2,64!==u&&(i[l++]=(3&o)<<6|u));return e?l-r:i.subarray(0,l)},i.text={utf8:{},utf16:{}},i.text.utf8.encode=function(t,e,r){t=i.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var a=r,s=0;s<t.length;++s)n[a++]=t.charCodeAt(s);return e?a-r:n},i.text.utf8.decode=function(t){return i.decodeUtf8(String.fromCharCode.apply(null,t))},i.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length));var n=new Uint16Array(i);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)n[s++]=t.charCodeAt(o),a+=2;return e?a-r:i},i.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},i.deflate=function(t,e,r){if(e=i.decode64(t.deflate(i.encode64(e)).rval),r){var n=2,a=e.charCodeAt(1);32&a&&(n=6),e=e.substring(n,e.length-4)}return e},i.inflate=function(t,e,r){var n=t.inflate(i.encode64(e)).rval;return null===n?null:i.decode64(n)};var o=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(null===r?n=t.removeItem(e):(r=i.encode64(JSON.stringify(r)),n=t.setItem(e,r)),"undefined"!=typeof n&&n.rval!==!0){var a=new Error(n.error.message);throw a.id=n.error.id,a.name=n.error.name,a}},u=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(i.decode64(r))),r},c=function(t,e,r,i){var n=u(t,e);null===n&&(n={}),n[r]=i,o(t,e,n)},l=function(t,e,r){var i=u(t,e);return null!==i&&(i=r in i?i[r]:null),i},f=function(t,e,r){var i=u(t,e);if(null!==i&&r in i){delete i[r];var n=!0;for(var a in i){n=!1;break}n&&(i=null),o(t,e,i)}},p=function(t,e){o(t,e,null)},h=function(t,e,r){var i=null;"undefined"==typeof r&&(r=["web","flash"]);var n,a=!1,s=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===e[0])throw new Error("Flash local storage not available.");i=t.apply(this,e),a="flash"===n}("web"===n||"both"===n)&&(e[0]=localStorage,i=t.apply(this,e),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return i};i.setItem=function(t,e,r,i,n){h(c,arguments,n)},i.getItem=function(t,e,r,i){return h(l,arguments,i)},i.removeItem=function(t,e,r,i){h(f,arguments,i)},i.clearItems=function(t,e,r){h(p,arguments,r)},i.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=null===r?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?80!==i.port&&"http"===i.scheme?i.fullHost+=":"+i.port:443!==i.port&&"https"===i.scheme&&(i.fullHost+=":"+i.port):"http"===i.scheme?i.port=80:"https"===i.scheme&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var d=null;i.getQueryVariables=function(t){var e,r=function(t){for(var e={},r=t.split("&"),i=0;i<r.length;i++){var n,a,s=r[i].indexOf("=");s>0?(n=r[i].substring(0,s),a=r[i].substring(s+1)):(n=r[i],a=null),n in e||(e[n]=[]),n in Object.prototype||null===a||e[n].push(unescape(a))}return e};return"undefined"==typeof t?(null===d&&(d="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),e=d):e=r(t),e},i.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");n>0&&(e=t.substring(0,n),r=t.substring(n+1));var a=e.split("/");a.length>0&&""===a[0]&&a.shift();var s=""===r?{}:i.getQueryVariables(r);return{pathString:e,queryString:r,path:a,query:s}},i.makeRequest=function(t){var e=i.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(t){return"undefined"==typeof t?e.path:e.path[t]},getQuery:function(t,r){var i;return"undefined"==typeof t?i=e.query:(i=e.query[t],i&&"undefined"!=typeof r&&(i=i[r])),i},getQueryLast:function(t,e){var i,n=r.getQuery(t);return i=n?n[n.length-1]:e}};return r},i.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")},i.setPath=function(t,e,r){if("object"==typeof t&&null!==t)for(var i=0,n=e.length;n>i;){var a=e[i++];if(i==n)t[a]=r;else{var s=a in t;(!s||s&&"object"!=typeof t[a]||s&&null===t[a])&&(t[a]={}),t=t[a]}}},i.getPath=function(t,e,r){for(var i=0,n=e.length,a=!0;a&&n>i&&"object"==typeof t&&null!==t;){var s=e[i++];a=s in t,a&&(t=t[s])}return a?t:r},i.deletePath=function(t,e){if("object"==typeof t&&null!==t)for(var r=0,i=e.length;i>r;){var n=e[r++];if(r==i)delete t[n];else{if(!(n in t)||"object"!=typeof t[n]||null===t[n])break;t=t[n]}}},i.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},i.format=function(t){for(var e,r,i=/%./g,n=0,a=[],s=0;e=i.exec(t);){r=t.substring(s,i.lastIndex-2),r.length>0&&a.push(r),s=i.lastIndex;var o=e[0][1];switch(o){case"s":case"o":n<arguments.length?a.push(arguments[n++ +1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")},i.formatNumber=function(t,e,r,i){var n=t,a=isNaN(e=Math.abs(e))?2:e,s=void 0===r?",":r,o=void 0===i?".":i,u=0>n?"-":"",c=parseInt(n=Math.abs(+n||0).toFixed(a),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+o:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(n-c).toFixed(a).slice(2):"")},i.formatSize=function(t){return t=t>=1073741824?i.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?i.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?i.formatNumber(t/1024,0)+" KiB":i.formatNumber(t,0)+" bytes"},i.bytesFromIP=function(t){return-1!==t.indexOf(".")?i.bytesFromIPv4(t):-1!==t.indexOf(":")?i.bytesFromIPv6(t):null},i.bytesFromIPv4=function(t){if(t=t.split("."),4!==t.length)return null;for(var e=i.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()},i.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(t){return 0===t.length&&++e,!0});for(var r=2*(8-t.length+e),n=i.createBuffer(),a=0;8>a;++a)if(t[a]&&0!==t[a].length){var s=i.hexToBytes(t[a]);s.length<2&&n.putByte(0),n.putBytes(s)}else n.fillWithByte(0,r),r=0;return n.getBytes()},i.bytesToIP=function(t){return 4===t.length?i.bytesToIPv4(t):16===t.length?i.bytesToIPv6(t):null},i.bytesToIPv4=function(t){if(4!==t.length)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")},i.bytesToIPv6=function(t){if(16!==t.length)return null;for(var e=[],r=[],n=0,a=0;a<t.length;a+=2){for(var s=i.bytesToHex(t[a]+t[a+1]);"0"===s[0]&&"0"!==s;)s=s.substr(1);if("0"===s){var o=r[r.length-1],u=e.length;o&&u===o.end+1?(o.end=u,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:u,end:u})}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),0===c.start&&e.unshift(""),7===c.end&&e.push(""))}return e.join(":")},i.estimateCores=function(t,e){function r(t,o,u){if(0===o){var c=Math.floor(t.reduce(function(t,e){return t+e},0)/t.length);return i.cores=Math.max(1,c),URL.revokeObjectURL(s),e(null,i.cores)}n(u,function(e,i){t.push(a(u,i)),r(t,o-1,u)})}function n(t,e){for(var r=[],i=[],n=0;t>n;++n){var a=new Worker(s);a.addEventListener("message",function(n){if(i.push(n.data),i.length===t){for(var a=0;t>a;++a)r[a].terminate();e(null,i)}}),r.push(a)}for(var n=0;t>n;++n)r[n].postMessage(n)}function a(t,e){for(var r=[],i=0;t>i;++i)for(var n=e[i],a=r[i]=[],s=0;t>s;++s)if(i!==s){var o=e[s];(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et)&&a.push(s)}return r.reduce(function(t,e){return Math.max(t,e.length)},0)}if("function"==typeof t&&(e=t,t={}),t=t||{},"cores"in i&&!t.update)return e(null,i.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return i.cores=navigator.hardwareConcurrency,e(null,i.cores);if("undefined"==typeof Worker)return i.cores=1,e(null,i.cores);if("undefined"==typeof Blob)return i.cores=2,e(null,i.cores);var s=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(t){for(var e=Date.now(),r=e+4;Date.now()<r;);self.postMessage({st:e,et:r})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)}}var i="util";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){t.cipher=t.cipher||{},t.cipher.algorithms=t.cipher.algorithms||{},t.cipher.createCipher=function(e,r){var i=e;if("string"==typeof i&&(i=t.cipher.getAlgorithm(i),i&&(i=i())),!i)throw new Error("Unsupported algorithm: "+e);return new t.cipher.BlockCipher({algorithm:i,key:r,decrypt:!1})},t.cipher.createDecipher=function(e,r){var i=e;if("string"==typeof i&&(i=t.cipher.getAlgorithm(i),i&&(i=i())),!i)throw new Error("Unsupported algorithm: "+e);return new t.cipher.BlockCipher({algorithm:i,key:r,decrypt:!0})},t.cipher.registerAlgorithm=function(e,r){e=e.toUpperCase(),t.cipher.algorithms[e]=r},t.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in t.cipher.algorithms?t.cipher.algorithms[e]:null};var e=t.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};e.prototype.start=function(e){e=e||{};var r={};for(var i in e)r[i]=e[i];r.decrypt=this._decrypt,this._finish=!1,this._input=t.util.createBuffer(),this.output=e.output||t.util.createBuffer(),this.mode.start(r)},e.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(t){!t||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(e){return t(this.blockSize,e,!1)},this.mode.unpad=function(e){return t(this.blockSize,e,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,this._decrypt||!this.mode.pad||this.mode.pad(this._input,e)?(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,e)?!1:!0):!1}}var i="cipher";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipher",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(e){if("string"==typeof e&&(e=t.util.createBuffer(e)),t.util.isArray(e)&&e.length>4){var r=e;e=t.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}return t.util.isArray(e)||(e=[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]),e}function r(t){t[t.length-1]=t[t.length-1]+1&4294967295}function i(t){return[t/4294967296|0,4294967295&t]}t.cipher=t.cipher||{};var n=t.cipher.modes=t.cipher.modes||{};n.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},n.ecb.prototype.start=function(t){},n.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])},n.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])},n.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0},n.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),
  !0)},n.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},n.cbc.prototype.start=function(t){if(null===t.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv),this._prev=this._iv.slice(0)}},n.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock},n.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)},n.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0},n.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)},n.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},n.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize)for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);else{var a=(this.blockSize-i)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(a>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}},n.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize)for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);else{var a=(this.blockSize-i)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(a>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}},n.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},n.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(0===t.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];else{var a=(this.blockSize-i)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(a>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}},n.ofb.prototype.decrypt=n.ofb.prototype.encrypt,n.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0},n.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=e(t.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},n.ctr.prototype.encrypt=function(t,e,i){var n=t.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var a=0;a<this._ints;++a)e.putInt32(t.getInt32()^this._outBlock[a]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(t.getInt32()^this._outBlock[a]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!i)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}r(this._inBlock)},n.ctr.prototype.decrypt=n.ctr.prototype.encrypt,n.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=t.util.createBuffer(),this._partialBytes=0,this._R=3774873600},n.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var n=t.util.createBuffer(e.iv);this._cipherLength=0;var a;if(a="additionalData"in e?t.util.createBuffer(e.additionalData):t.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=t.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=n.length();if(12===s)this._j0=[n.getInt32(),n.getInt32(),n.getInt32(),1];else{for(this._j0=[0,0,0,0];n.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(i(8*s)))}this._inBlock=this._j0.slice(0),r(this._inBlock),this._partialBytes=0,a=t.util.createBuffer(a),this._aDataLength=i(8*a.length());var o=a.length()%this.blockSize;for(o&&a.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])},n.gcm.prototype.encrypt=function(t,e,i){var n=t.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(t.getInt32()^this._outBlock[a]);if(0===s||i){if(i){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!i)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),r(this._inBlock)},n.gcm.prototype.decrypt=function(t,e,i){var n=t.length();if(n<this.blockSize&&!(i&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),r(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^this._hashBlock[a]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},n.gcm.prototype.afterFinish=function(e,r){var n=!0;r.decrypt&&r.overflow&&e.truncate(this.blockSize-r.overflow),this.tag=t.util.createBuffer();var a=this._aDataLength.concat(i(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,a);var s=[];this.cipher.encrypt(this._j0,s);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^s[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),r.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},n.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;128>n;++n){var a=t[n/32|0]&1<<31-n%32;a&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r},n.gcm.prototype.pow=function(t,e){for(var r=1&t[3],i=3;i>0;--i)e[i]=t[i]>>>1|(1&t[i-1])<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)},n.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;32>r;++r){var i=r/8|0,n=t[i]>>>4*(7-r%8)&15,a=this._m[r][n];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e},n.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)},n.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,a=new Array(n),s=0;n>s;++s){var o=[0,0,0,0],u=s/i|0,c=(i-1-s%i)*e;o[u]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a},n.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var a=i>>>1;a>0;)this.pow(n[2*a],n[a]=[]),a>>=1;for(a=2;i>a;){for(var s=1;a>s;++s){var o=n[a],u=n[s];n[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(n[0]=[0,0,0,0],a=i+1;r>a;++a){var c=n[a^i];n[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return n}}var i="cipherModes";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipherModes",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(e,r){var i=function(){return new t.aes.Algorithm(e,r)};t.cipher.registerAlgorithm(e,i)}function r(){f=!0,u=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;128>e;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;s=new Array(256),o=new Array(256),c=new Array(4),l=new Array(4);for(var e=0;4>e;++e)c[e]=new Array(256),l[e]=new Array(256);for(var r,i,n,a,p,h,d,y=0,g=0,e=0;256>e;++e){a=g^g<<1^g<<2^g<<3^g<<4,a=a>>8^255&a^99,s[y]=a,o[a]=y,p=t[a],r=t[y],i=t[r],n=t[i],h=p<<24^a<<16^a<<8^(a^p),d=(r^i^n)<<24^(y^n)<<16^(y^i^n)<<8^(y^r^n);for(var m=0;4>m;++m)c[m][y]=h,l[m][a]=d,h=h<<24|h>>>8,d=d<<24|d>>>8;0===y?y=g=1:(y=r^t[t[t[r^n]]],g^=t[t[g]])}}function i(t,e){for(var r,i=t.slice(0),n=1,a=i.length,o=a+6+1,c=p*o,f=a;c>f;++f)r=i[f-1],f%a===0?(r=s[r>>>16&255]<<24^s[r>>>8&255]<<16^s[255&r]<<8^s[r>>>24]^u[n]<<24,n++):a>6&&f%a===4&&(r=s[r>>>24]<<24^s[r>>>16&255]<<16^s[r>>>8&255]<<8^s[255&r]),i[f]=i[f-a]^r;if(e){var h,d=l[0],y=l[1],g=l[2],m=l[3],v=i.slice(0);c=i.length;for(var f=0,C=c-p;c>f;f+=p,C-=p)if(0===f||f===c-p)v[f]=i[C],v[f+1]=i[C+3],v[f+2]=i[C+2],v[f+3]=i[C+1];else for(var E=0;p>E;++E)h=i[C+E],v[f+(3&-E)]=d[s[h>>>24]]^y[s[h>>>16&255]]^g[s[h>>>8&255]]^m[s[255&h]];i=v}return i}function n(t,e,r,i){var n,a,u,f,p,h=t.length/4-1;i?(n=l[0],a=l[1],u=l[2],f=l[3],p=o):(n=c[0],a=c[1],u=c[2],f=c[3],p=s);var d,y,g,m,v,C,E;d=e[0]^t[0],y=e[i?3:1]^t[1],g=e[2]^t[2],m=e[i?1:3]^t[3];for(var S=3,T=1;h>T;++T)v=n[d>>>24]^a[y>>>16&255]^u[g>>>8&255]^f[255&m]^t[++S],C=n[y>>>24]^a[g>>>16&255]^u[m>>>8&255]^f[255&d]^t[++S],E=n[g>>>24]^a[m>>>16&255]^u[d>>>8&255]^f[255&y]^t[++S],m=n[m>>>24]^a[d>>>16&255]^u[y>>>8&255]^f[255&g]^t[++S],d=v,y=C,g=E;r[0]=p[d>>>24]<<24^p[y>>>16&255]<<16^p[g>>>8&255]<<8^p[255&m]^t[++S],r[i?3:1]=p[y>>>24]<<24^p[g>>>16&255]<<16^p[m>>>8&255]<<8^p[255&d]^t[++S],r[2]=p[g>>>24]<<24^p[m>>>16&255]<<16^p[d>>>8&255]<<8^p[255&y]^t[++S],r[i?1:3]=p[m>>>24]<<24^p[d>>>16&255]<<16^p[y>>>8&255]<<8^p[255&g]^t[++S]}function a(e){e=e||{};var r,i=(e.mode||"CBC").toUpperCase(),n="AES-"+i;r=e.decrypt?t.cipher.createDecipher(n,e.key):t.cipher.createCipher(n,e.key);var a=r.start;return r.start=function(e,i){var n=null;i instanceof t.util.ByteBuffer&&(n=i,i={}),i=i||{},i.output=n,i.iv=e,a.call(r,i)},r}t.aes=t.aes||{},t.aes.startEncrypting=function(t,e,r,i){var n=a({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n},t.aes.createEncryptionCipher=function(t,e){return a({key:t,output:null,decrypt:!1,mode:e})},t.aes.startDecrypting=function(t,e,r,i){var n=a({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n},t.aes.createDecryptionCipher=function(t,e){return a({key:t,output:null,decrypt:!0,mode:e})},t.aes.Algorithm=function(t,e){f||r();var i=this;i.name=t,i.mode=new e({blockSize:16,cipher:{encrypt:function(t,e){return n(i._w,t,e,!1)},decrypt:function(t,e){return n(i._w,t,e,!0)}}}),i._init=!1},t.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var r,n=e.key;if("string"!=typeof n||16!==n.length&&24!==n.length&&32!==n.length){if(t.util.isArray(n)&&(16===n.length||24===n.length||32===n.length)){r=n,n=t.util.createBuffer();for(var a=0;a<r.length;++a)n.putByte(r[a])}}else n=t.util.createBuffer(n);if(!t.util.isArray(n)){r=n,n=[];var s=r.length();if(16===s||24===s||32===s){s>>>=2;for(var a=0;s>a;++a)n.push(r.getInt32())}}if(!t.util.isArray(n)||4!==n.length&&6!==n.length&&8!==n.length)throw new Error("Invalid key parameter.");var o=this.mode.name,u=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=i(n,e.decrypt&&!u),this._init=!0}},t.aes._expandKey=function(t,e){return f||r(),i(t,e)},t.aes._updateBlock=n,e("AES-ECB",t.cipher.modes.ecb),e("AES-CBC",t.cipher.modes.cbc),e("AES-CFB",t.cipher.modes.cfb),e("AES-OFB",t.cipher.modes.ofb),e("AES-CTR",t.cipher.modes.ctr),e("AES-GCM",t.cipher.modes.gcm);var s,o,u,c,l,f=!1,p=4}var i="aes";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){t.pki=t.pki||{};var e=t.pki.oids=t.oids=t.oids||{};e["1.2.840.113549.1.1.1"]="rsaEncryption",e.rsaEncryption="1.2.840.113549.1.1.1",e["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",e.md5WithRSAEncryption="1.2.840.113549.1.1.4",e["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",e.sha1WithRSAEncryption="1.2.840.113549.1.1.5",e["1.2.840.113549.1.1.7"]="RSAES-OAEP",e["RSAES-OAEP"]="1.2.840.113549.1.1.7",e["1.2.840.113549.1.1.8"]="mgf1",e.mgf1="1.2.840.113549.1.1.8",e["1.2.840.113549.1.1.9"]="pSpecified",e.pSpecified="1.2.840.113549.1.1.9",e["1.2.840.113549.1.1.10"]="RSASSA-PSS",e["RSASSA-PSS"]="1.2.840.113549.1.1.10",e["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",e.sha256WithRSAEncryption="1.2.840.113549.1.1.11",e["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",e.sha384WithRSAEncryption="1.2.840.113549.1.1.12",e["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",e.sha512WithRSAEncryption="1.2.840.113549.1.1.13",e["1.3.14.3.2.7"]="desCBC",e.desCBC="1.3.14.3.2.7",e["1.3.14.3.2.26"]="sha1",e.sha1="1.3.14.3.2.26",e["2.16.840.1.101.3.4.2.1"]="sha256",e.sha256="2.16.840.1.101.3.4.2.1",e["2.16.840.1.101.3.4.2.2"]="sha384",e.sha384="2.16.840.1.101.3.4.2.2",e["2.16.840.1.101.3.4.2.3"]="sha512",e.sha512="2.16.840.1.101.3.4.2.3",e["1.2.840.113549.2.5"]="md5",e.md5="1.2.840.113549.2.5",e["1.2.840.113549.1.7.1"]="data",e.data="1.2.840.113549.1.7.1",e["1.2.840.113549.1.7.2"]="signedData",e.signedData="1.2.840.113549.1.7.2",e["1.2.840.113549.1.7.3"]="envelopedData",e.envelopedData="1.2.840.113549.1.7.3",e["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",e.signedAndEnvelopedData="1.2.840.113549.1.7.4",e["1.2.840.113549.1.7.5"]="digestedData",e.digestedData="1.2.840.113549.1.7.5",e["1.2.840.113549.1.7.6"]="encryptedData",e.encryptedData="1.2.840.113549.1.7.6",e["1.2.840.113549.1.9.1"]="emailAddress",e.emailAddress="1.2.840.113549.1.9.1",e["1.2.840.113549.1.9.2"]="unstructuredName",e.unstructuredName="1.2.840.113549.1.9.2",e["1.2.840.113549.1.9.3"]="contentType",e.contentType="1.2.840.113549.1.9.3",e["1.2.840.113549.1.9.4"]="messageDigest",e.messageDigest="1.2.840.113549.1.9.4",e["1.2.840.113549.1.9.5"]="signingTime",e.signingTime="1.2.840.113549.1.9.5",e["1.2.840.113549.1.9.6"]="counterSignature",e.counterSignature="1.2.840.113549.1.9.6",e["1.2.840.113549.1.9.7"]="challengePassword",e.challengePassword="1.2.840.113549.1.9.7",e["1.2.840.113549.1.9.8"]="unstructuredAddress",e.unstructuredAddress="1.2.840.113549.1.9.8",e["1.2.840.113549.1.9.14"]="extensionRequest",e.extensionRequest="1.2.840.113549.1.9.14",e["1.2.840.113549.1.9.20"]="friendlyName",e.friendlyName="1.2.840.113549.1.9.20",e["1.2.840.113549.1.9.21"]="localKeyId",e.localKeyId="1.2.840.113549.1.9.21",e["1.2.840.113549.1.9.22.1"]="x509Certificate",e.x509Certificate="1.2.840.113549.1.9.22.1",e["1.2.840.113549.1.12.10.1.1"]="keyBag",e.keyBag="1.2.840.113549.1.12.10.1.1",e["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",e.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",e["1.2.840.113549.1.12.10.1.3"]="certBag",e.certBag="1.2.840.113549.1.12.10.1.3",e["1.2.840.113549.1.12.10.1.4"]="crlBag",e.crlBag="1.2.840.113549.1.12.10.1.4",e["1.2.840.113549.1.12.10.1.5"]="secretBag",e.secretBag="1.2.840.113549.1.12.10.1.5",e["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",e.safeContentsBag="1.2.840.113549.1.12.10.1.6",e["1.2.840.113549.1.5.13"]="pkcs5PBES2",e.pkcs5PBES2="1.2.840.113549.1.5.13",e["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",e.pkcs5PBKDF2="1.2.840.113549.1.5.12",e["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",e.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",e["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",e.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",e["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",e["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",e["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",e["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",e["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",e["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",e["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",e["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",e["1.2.840.113549.3.7"]="des-EDE3-CBC",e["des-EDE3-CBC"]="1.2.840.113549.3.7",e["2.16.840.1.101.3.4.1.2"]="aes128-CBC",e["aes128-CBC"]="2.16.840.1.101.3.4.1.2",e["2.16.840.1.101.3.4.1.22"]="aes192-CBC",e["aes192-CBC"]="2.16.840.1.101.3.4.1.22",e["2.16.840.1.101.3.4.1.42"]="aes256-CBC",e["aes256-CBC"]="2.16.840.1.101.3.4.1.42",e["2.5.4.3"]="commonName",e.commonName="2.5.4.3",e["2.5.4.5"]="serialName",e.serialName="2.5.4.5",e["2.5.4.6"]="countryName",e.countryName="2.5.4.6",e["2.5.4.7"]="localityName",e.localityName="2.5.4.7",e["2.5.4.8"]="stateOrProvinceName",e.stateOrProvinceName="2.5.4.8",e["2.5.4.10"]="organizationName",e.organizationName="2.5.4.10",e["2.5.4.11"]="organizationalUnitName",e.organizationalUnitName="2.5.4.11",e["2.16.840.1.113730.1.1"]="nsCertType",e.nsCertType="2.16.840.1.113730.1.1",e["2.5.29.1"]="authorityKeyIdentifier",e["2.5.29.2"]="keyAttributes",e["2.5.29.3"]="certificatePolicies",e["2.5.29.4"]="keyUsageRestriction",e["2.5.29.5"]="policyMapping",e["2.5.29.6"]="subtreesConstraint",e["2.5.29.7"]="subjectAltName",e["2.5.29.8"]="issuerAltName",e["2.5.29.9"]="subjectDirectoryAttributes",e["2.5.29.10"]="basicConstraints",e["2.5.29.11"]="nameConstraints",e["2.5.29.12"]="policyConstraints",e["2.5.29.13"]="basicConstraints",e["2.5.29.14"]="subjectKeyIdentifier",e.subjectKeyIdentifier="2.5.29.14",e["2.5.29.15"]="keyUsage",e.keyUsage="2.5.29.15",e["2.5.29.16"]="privateKeyUsagePeriod",e["2.5.29.17"]="subjectAltName",e.subjectAltName="2.5.29.17",e["2.5.29.18"]="issuerAltName",e.issuerAltName="2.5.29.18",e["2.5.29.19"]="basicConstraints",e.basicConstraints="2.5.29.19",e["2.5.29.20"]="cRLNumber",e["2.5.29.21"]="cRLReason",e["2.5.29.22"]="expirationDate",e["2.5.29.23"]="instructionCode",e["2.5.29.24"]="invalidityDate",e["2.5.29.25"]="cRLDistributionPoints",e["2.5.29.26"]="issuingDistributionPoint",e["2.5.29.27"]="deltaCRLIndicator",e["2.5.29.28"]="issuingDistributionPoint",e["2.5.29.29"]="certificateIssuer",e["2.5.29.30"]="nameConstraints",e["2.5.29.31"]="cRLDistributionPoints",e["2.5.29.32"]="certificatePolicies",e["2.5.29.33"]="policyMappings",e["2.5.29.34"]="policyConstraints",e["2.5.29.35"]="authorityKeyIdentifier",e["2.5.29.36"]="policyConstraints",e["2.5.29.37"]="extKeyUsage",e.extKeyUsage="2.5.29.37",e["2.5.29.46"]="freshestCRL",e["2.5.29.54"]="inhibitAnyPolicy",e["1.3.6.1.5.5.7.3.1"]="serverAuth",e.serverAuth="1.3.6.1.5.5.7.3.1",e["1.3.6.1.5.5.7.3.2"]="clientAuth",e.clientAuth="1.3.6.1.5.5.7.3.2",e["1.3.6.1.5.5.7.3.3"]="codeSigning",e.codeSigning="1.3.6.1.5.5.7.3.3",e["1.3.6.1.5.5.7.3.4"]="emailProtection",e.emailProtection="1.3.6.1.5.5.7.3.4",e["1.3.6.1.5.5.7.3.8"]="timeStamping",e.timeStamping="1.3.6.1.5.5.7.3.8"}var i="oids";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){var e=t.asn1=t.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(e,r,i,n){if(t.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)void 0!==n[s]&&a.push(n[s]);n=a}return{tagClass:e,type:r,constructed:i,composed:i||t.util.isArray(n),value:n}};var r=e.getBerValueLength=function(t){var e=t.getByte();if(128!==e){var r,i=128&e;return r=i?t.getInt((127&e)<<3):e}};e.fromDer=function(i,n){if(void 0===n&&(n=!0),"string"==typeof i&&(i=t.util.createBuffer(i)),i.length()<2){var a=new Error("Too few bytes to parse DER.");throw a.bytes=i.length(),a}var s=i.getByte(),o=192&s,u=31&s,c=r(i);if(i.length()<c){if(n){var a=new Error("Too few bytes to read ASN.1 value.");throw a.detail=i.length()+" < "+c,a}c=i.length()}var l,f=32===(32&s),p=f;if(!p&&o===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&c>1){var h=i.read,d=i.getByte();if(0===d){s=i.getByte();var y=192&s;if(y===e.Class.UNIVERSAL||y===e.Class.CONTEXT_SPECIFIC)try{var g=r(i);p=g===c-(i.read-h),p&&(++h,--c)}catch(m){}}i.read=h}if(p)if(l=[],void 0===c)for(;;){if(i.bytes(2)===String.fromCharCode(0,0)){i.getBytes(2);break}l.push(e.fromDer(i,n))}else for(var v=i.length();c>0;)l.push(e.fromDer(i,n)),c-=v-i.length(),v=i.length();else{if(void 0===c){if(n)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=i.length()}if(u===e.Type.BMPSTRING){l="";for(var C=0;c>C;C+=2)l+=String.fromCharCode(i.getInt16())}else l=i.getBytes(c)}return e.create(o,u,f,l)},e.toDer=function(r){var i=t.util.createBuffer(),n=r.tagClass|r.type,a=t.util.createBuffer();if(r.composed){r.constructed?n|=32:a.putByte(0);for(var s=0;s<r.value.length;++s)void 0!==r.value[s]&&a.putBuffer(e.toDer(r.value[s]))}else if(r.type===e.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)a.putInt16(r.value.charCodeAt(s));else a.putBytes(r.value);if(i.putByte(n),a.length()<=127)i.putByte(127&a.length());else{var o=a.length(),u="";do u+=String.fromCharCode(255&o),o>>>=8;while(o>0);i.putByte(128|u.length);for(var s=u.length-1;s>=0;--s)i.putByte(u.charCodeAt(s))}return i.putBuffer(a),i},e.oidToDer=function(e){var r=e.split("."),i=t.util.createBuffer();i.putByte(40*parseInt(r[0],10)+parseInt(r[1],10));for(var n,a,s,o,u=2;u<r.length;++u){n=!0,a=[],s=parseInt(r[u],10);do o=127&s,s>>>=7,n||(o|=128),a.push(o),n=!1;while(s>0);for(var c=a.length-1;c>=0;--c)i.putByte(a[c])}return i},e.derToOid=function(e){var r;"string"==typeof e&&(e=t.util.createBuffer(e));var i=e.getByte();r=Math.floor(i/40)+"."+i%40;for(var n=0;e.length()>0;)i=e.getByte(),n<<=7,128&i?n+=127&i:(r+="."+(n+i),n=0);return r},e.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var u=t.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(a,s,o,0),c&&(u=t.charAt(c),"+"===u||"-"===u)){var l=parseInt(t.substr(c+1,2),10),f=parseInt(t.substr(c+4,2),10),p=60*l+f;p*=6e4,"+"===u?e.setTime(+e-p):e.setTime(+e+p)}return e},e.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),u=0,c=0,l=!1;"Z"===t.charAt(t.length-1)&&(l=!0);var f=t.length-5,p=t.charAt(f);if("+"===p||"-"===p){var h=parseInt(t.substr(f+1,2),10),d=parseInt(t.substr(f+4,2),10);c=60*h+d,c*=6e4,"+"===p&&(c*=-1),l=!0}return"."===t.charAt(14)&&(u=1e3*parseFloat(t.substr(14),10)),l?(e.setUTCFullYear(r,i,n),e.setUTCHours(a,s,o,u),e.setTime(+e+c)):(e.setFullYear(r,i,n),e.setHours(a,s,o,u)),e},e.dateToUtcTime=function(t){if("string"==typeof t)return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z"},e.dateToGeneralizedTime=function(t){if("string"==typeof t)return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z"},e.integerToDer=function(e){var r=t.util.createBuffer();if(e>=-128&&128>e)return r.putSignedInt(e,8);if(e>=-32768&&32768>e)return r.putSignedInt(e,16);if(e>=-8388608&&8388608>e)return r.putSignedInt(e,24);if(e>=-2147483648&&2147483648>e)return r.putSignedInt(e,32);var i=new Error("Integer too large; max is 32-bits.");throw i.integer=e,i},e.derToInteger=function(e){"string"==typeof e&&(e=t.util.createBuffer(e));var r=8*e.length();if(r>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(r)},e.validate=function(r,i,n,a){var s=!1;if(r.tagClass!==i.tagClass&&"undefined"!=typeof i.tagClass||r.type!==i.type&&"undefined"!=typeof i.type)a&&(r.tagClass!==i.tagClass&&a.push("["+i.name+'] Expected tag class "'+i.tagClass+'", got "'+r.tagClass+'"'),r.type!==i.type&&a.push("["+i.name+'] Expected type "'+i.type+'", got "'+r.type+'"'));else if(r.constructed===i.constructed||"undefined"==typeof i.constructed){if(s=!0,i.value&&t.util.isArray(i.value))for(var o=0,u=0;s&&u<i.value.length;++u)s=i.value[u].optional||!1,r.value[o]&&(s=e.validate(r.value[o],i.value[u],n,a),s?++o:i.value[u].optional&&(s=!0)),!s&&a&&a.push("["+i.name+'] Tag class "'+i.tagClass+'", type "'+i.type+'" expected value length "'+i.value.length+'", got "'+r.value.length+'"');s&&n&&(i.capture&&(n[i.capture]=r.value),i.captureAsn1&&(n[i.captureAsn1]=r))}else a&&a.push("["+i.name+'] Expected constructed "'+i.constructed+'", got "'+r.constructed+'"');return s};var i=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(r,n,a){var s="";n=n||0,a=a||2,n>0&&(s+="\n");for(var o="",u=0;n*a>u;++u)o+=" ";switch(s+=o+"Tag: ",r.tagClass){case e.Class.UNIVERSAL:s+="Universal:";break;case e.Class.APPLICATION:s+="Application:";break;case e.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case e.Class.PRIVATE:s+="Private:"}if(r.tagClass===e.Class.UNIVERSAL)switch(s+=r.type,r.type){case e.Type.NONE:s+=" (None)";break;case e.Type.BOOLEAN:s+=" (Boolean)";break;case e.Type.BITSTRING:s+=" (Bit string)";break;case e.Type.INTEGER:s+=" (Integer)";break;case e.Type.OCTETSTRING:s+=" (Octet string)";break;case e.Type.NULL:s+=" (Null)";break;case e.Type.OID:s+=" (Object Identifier)";break;case e.Type.ODESC:s+=" (Object Descriptor)";break;case e.Type.EXTERNAL:s+=" (External or Instance of)";break;case e.Type.REAL:s+=" (Real)";break;case e.Type.ENUMERATED:s+=" (Enumerated)";break;case e.Type.EMBEDDED:s+=" (Embedded PDV)";break;case e.Type.UTF8:s+=" (UTF8)";break;case e.Type.ROID:s+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:s+=" (Sequence)";break;case e.Type.SET:s+=" (Set)";break;case e.Type.PRINTABLESTRING:s+=" (Printable String)";break;case e.Type.IA5String:s+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:s+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case e.Type.BMPSTRING:s+=" (BMP String)"}else s+=r.type;if(s+="\n",s+=o+"Constructed: "+r.constructed+"\n",r.composed){for(var c=0,l="",u=0;u<r.value.length;++u)void 0!==r.value[u]&&(c+=1,l+=e.prettyPrint(r.value[u],n+1,a),u+1<r.value.length&&(l+=","));s+=o+"Sub values: "+c+l}else{if(s+=o+"Value: ",r.type===e.Type.OID){var f=e.derToOid(r.value);s+=f,t.pki&&t.pki.oids&&f in t.pki.oids&&(s+=" ("+t.pki.oids[f]+") ")}if(r.type===e.Type.INTEGER)try{s+=e.derToInteger(r.value)}catch(p){s+="0x"+t.util.bytesToHex(r.value)}else r.type===e.Type.OCTETSTRING?(i.test(r.value)||(s+="("+r.value+") "),s+="0x"+t.util.bytesToHex(r.value)):s+=r.type===e.Type.UTF8?t.util.decodeUtf8(r.value):r.type===e.Type.PRINTABLESTRING||r.type===e.Type.IA5String?r.value:i.test(r.value)?"0x"+t.util.bytesToHex(r.value):0===r.value.length?"[null]":r.value}return s}}var i="asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),
  t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(){n=String.fromCharCode(128),n+=t.util.fillString(String.fromCharCode(0),64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],s=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],o=new Array(64);for(var e=0;64>e;++e)o[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));u=!0}function r(t,e,r){for(var i,n,u,c,l,f,p,h,d=r.length();d>=64;){for(n=t.h0,u=t.h1,c=t.h2,l=t.h3,h=0;16>h;++h)e[h]=r.getInt32Le(),f=l^u&(c^l),i=n+f+o[h]+e[h],p=s[h],n=l,l=c,c=u,u+=i<<p|i>>>32-p;for(;32>h;++h)f=c^l&(u^c),i=n+f+o[h]+e[a[h]],p=s[h],n=l,l=c,c=u,u+=i<<p|i>>>32-p;for(;48>h;++h)f=u^c^l,i=n+f+o[h]+e[a[h]],p=s[h],n=l,l=c,c=u,u+=i<<p|i>>>32-p;for(;64>h;++h)f=c^(u|~l),i=n+f+o[h]+e[a[h]],p=s[h],n=l,l=c,c=u,u+=i<<p|i>>>32-p;t.h0=t.h0+n|0,t.h1=t.h1+u|0,t.h2=t.h2+c|0,t.h3=t.h3+l|0,d-=64}}var i=t.md5=t.md5||{};t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},t.md.md5=t.md.algorithms.md5=i,i.create=function(){u||e();var i=null,a=t.util.createBuffer(),s=new Array(16),o={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return o.start=function(){return o.messageLength=0,o.messageLength64=[0,0],a=t.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},o},o.start(),o.update=function(e,n){return"utf8"===n&&(e=t.util.encodeUtf8(e)),o.messageLength+=e.length,o.messageLength64[0]+=e.length/4294967296>>>0,o.messageLength64[1]+=e.length>>>0,a.putBytes(e),r(i,s,a),(a.read>2048||0===a.length())&&a.compact(),o},o.digest=function(){var e=t.util.createBuffer();e.putBytes(a.bytes()),e.putBytes(n.substr(0,64-(o.messageLength64[1]+8&63))),e.putInt32Le(o.messageLength64[1]<<3),e.putInt32Le(o.messageLength64[0]<<3|o.messageLength64[0]>>>28);var u={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3};r(u,s,e);var c=t.util.createBuffer();return c.putInt32Le(u.h0),c.putInt32Le(u.h1),c.putInt32Le(u.h2),c.putInt32Le(u.h3),c},o};var n=null,a=null,s=null,o=null,u=!1}var i="md5";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(){n=String.fromCharCode(128),n+=t.util.fillString(String.fromCharCode(0),64),a=!0}function r(t,e,r){for(var i,n,a,s,o,u,c,l,f=r.length();f>=64;){for(n=t.h0,a=t.h1,s=t.h2,o=t.h3,u=t.h4,l=0;16>l;++l)i=r.getInt32(),e[l]=i,c=o^a&(s^o),i=(n<<5|n>>>27)+c+u+1518500249+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;for(;20>l;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,c=o^a&(s^o),i=(n<<5|n>>>27)+c+u+1518500249+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;for(;32>l;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,c=a^s^o,i=(n<<5|n>>>27)+c+u+1859775393+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;for(;40>l;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,c=a^s^o,i=(n<<5|n>>>27)+c+u+1859775393+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;for(;60>l;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,c=a&s|o&(a^s),i=(n<<5|n>>>27)+c+u+2400959708+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;for(;80>l;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,c=a^s^o,i=(n<<5|n>>>27)+c+u+3395469782+i,u=o,o=s,s=a<<30|a>>>2,a=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+u|0,f-=64}}var i=t.sha1=t.sha1||{};t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},t.md.sha1=t.md.algorithms.sha1=i,i.create=function(){a||e();var i=null,s=t.util.createBuffer(),o=new Array(80),u={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,messageLength64:[0,0]};return u.start=function(){return u.messageLength=0,u.messageLength64=[0,0],s=t.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},u},u.start(),u.update=function(e,n){return"utf8"===n&&(e=t.util.encodeUtf8(e)),u.messageLength+=e.length,u.messageLength64[0]+=e.length/4294967296>>>0,u.messageLength64[1]+=e.length>>>0,s.putBytes(e),r(i,o,s),(s.read>2048||0===s.length())&&s.compact(),u},u.digest=function(){var e=t.util.createBuffer();e.putBytes(s.bytes()),e.putBytes(n.substr(0,64-(u.messageLength64[1]+8&63))),e.putInt32(u.messageLength64[0]<<3|u.messageLength64[0]>>>28),e.putInt32(u.messageLength64[1]<<3);var a={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4};r(a,o,e);var c=t.util.createBuffer();return c.putInt32(a.h0),c.putInt32(a.h1),c.putInt32(a.h2),c.putInt32(a.h3),c.putInt32(a.h4),c},u};var n=null,a=!1}var i="sha1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(){n=String.fromCharCode(128),n+=t.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function r(t,e,r){for(var i,n,a,o,u,c,l,f,p,h,d,y,g,m,v,C=r.length();C>=64;){for(l=0;16>l;++l)e[l]=r.getInt32();for(;64>l;++l)i=e[l-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[l-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[l]=i+e[l-7]+n+e[l-16]|0;for(f=t.h0,p=t.h1,h=t.h2,d=t.h3,y=t.h4,g=t.h5,m=t.h6,v=t.h7,l=0;64>l;++l)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),u=m^y&(g^m),a=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&p|h&(f^p),i=v+o+u+s[l]+e[l],n=a+c,v=m,m=g,g=y,y=d+i|0,d=h,h=p,p=f,f=i+n|0;t.h0=t.h0+f|0,t.h1=t.h1+p|0,t.h2=t.h2+h|0,t.h3=t.h3+d|0,t.h4=t.h4+y|0,t.h5=t.h5+g|0,t.h6=t.h6+m|0,t.h7=t.h7+v|0,C-=64}}var i=t.sha256=t.sha256||{};t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},t.md.sha256=t.md.algorithms.sha256=i,i.create=function(){a||e();var i=null,s=t.util.createBuffer(),o=new Array(64),u={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return u.start=function(){return u.messageLength=0,u.messageLength64=[0,0],s=t.util.createBuffer(),i={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},u},u.start(),u.update=function(e,n){return"utf8"===n&&(e=t.util.encodeUtf8(e)),u.messageLength+=e.length,u.messageLength64[0]+=e.length/4294967296>>>0,u.messageLength64[1]+=e.length>>>0,s.putBytes(e),r(i,o,s),(s.read>2048||0===s.length())&&s.compact(),u},u.digest=function(){var e=t.util.createBuffer();e.putBytes(s.bytes()),e.putBytes(n.substr(0,64-(u.messageLength64[1]+8&63))),e.putInt32(u.messageLength64[0]<<3|u.messageLength64[0]>>>28),e.putInt32(u.messageLength64[1]<<3);var a={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4,h5:i.h5,h6:i.h6,h7:i.h7};r(a,o,e);var c=t.util.createBuffer();return c.putInt32(a.h0),c.putInt32(a.h1),c.putInt32(a.h2),c.putInt32(a.h3),c.putInt32(a.h4),c.putInt32(a.h5),c.putInt32(a.h6),c.putInt32(a.h7),c},u};var n=null,a=!1,s=null}var i="sha256";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(){a=String.fromCharCode(128),a+=t.util.fillString(String.fromCharCode(0),128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],u={},u["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],s=!0}function r(t,e,r){for(var i,n,a,s,u,c,l,f,p,h,d,y,g,m,v,C,E,S,T,I,A,b,B,N,R,w,U,L,k,D,O,P,_,V,x,K=r.length();K>=128;){for(k=0;16>k;++k)e[k][0]=r.getInt32()>>>0,e[k][1]=r.getInt32()>>>0;for(;80>k;++k)P=e[k-2],D=P[0],O=P[1],i=((D>>>19|O<<13)^(O>>>29|D<<3)^D>>>6)>>>0,n=((D<<13|O>>>19)^(O<<3|D>>>29)^(D<<26|O>>>6))>>>0,V=e[k-15],D=V[0],O=V[1],a=((D>>>1|O<<31)^(D>>>8|O<<24)^D>>>7)>>>0,s=((D<<31|O>>>1)^(D<<24|O>>>8)^(D<<25|O>>>7))>>>0,_=e[k-7],x=e[k-16],O=n+_[1]+s+x[1],e[k][0]=i+_[0]+a+x[0]+(O/4294967296>>>0)>>>0,e[k][1]=O>>>0;for(g=t[0][0],m=t[0][1],v=t[1][0],C=t[1][1],E=t[2][0],S=t[2][1],T=t[3][0],I=t[3][1],A=t[4][0],b=t[4][1],B=t[5][0],N=t[5][1],R=t[6][0],w=t[6][1],U=t[7][0],L=t[7][1],k=0;80>k;++k)l=((A>>>14|b<<18)^(A>>>18|b<<14)^(b>>>9|A<<23))>>>0,f=((A<<18|b>>>14)^(A<<14|b>>>18)^(b<<23|A>>>9))>>>0,p=(R^A&(B^R))>>>0,h=(w^b&(N^w))>>>0,u=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,c=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,d=(g&v|E&(g^v))>>>0,y=(m&C|S&(m^C))>>>0,O=L+f+h+o[k][1]+e[k][1],i=U+l+p+o[k][0]+e[k][0]+(O/4294967296>>>0)>>>0,n=O>>>0,O=c+y,a=u+d+(O/4294967296>>>0)>>>0,s=O>>>0,U=R,L=w,R=B,w=N,B=A,N=b,O=I+n,A=T+i+(O/4294967296>>>0)>>>0,b=O>>>0,T=E,I=S,E=v,S=C,v=g,C=m,O=n+s,g=i+a+(O/4294967296>>>0)>>>0,m=O>>>0;O=t[0][1]+m,t[0][0]=t[0][0]+g+(O/4294967296>>>0)>>>0,t[0][1]=O>>>0,O=t[1][1]+C,t[1][0]=t[1][0]+v+(O/4294967296>>>0)>>>0,t[1][1]=O>>>0,O=t[2][1]+S,t[2][0]=t[2][0]+E+(O/4294967296>>>0)>>>0,t[2][1]=O>>>0,O=t[3][1]+I,t[3][0]=t[3][0]+T+(O/4294967296>>>0)>>>0,t[3][1]=O>>>0,O=t[4][1]+b,t[4][0]=t[4][0]+A+(O/4294967296>>>0)>>>0,t[4][1]=O>>>0,O=t[5][1]+N,t[5][0]=t[5][0]+B+(O/4294967296>>>0)>>>0,t[5][1]=O>>>0,O=t[6][1]+w,t[6][0]=t[6][0]+R+(O/4294967296>>>0)>>>0,t[6][1]=O>>>0,O=t[7][1]+L,t[7][0]=t[7][0]+U+(O/4294967296>>>0)>>>0,t[7][1]=O>>>0,K-=128}}var i=t.sha512=t.sha512||{};t.md=t.md||{},t.md.algorithms=t.md.algorithms||{},t.md.sha512=t.md.algorithms.sha512=i;var n=t.sha384=t.sha512.sha384=t.sha512.sha384||{};n.create=function(){return i.create("SHA-384")},t.md.sha384=t.md.algorithms.sha384=n,t.sha512.sha256=t.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},t.md["sha512/256"]=t.md.algorithms["sha512/256"]=t.sha512.sha256,t.sha512.sha224=t.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},t.md["sha512/224"]=t.md.algorithms["sha512/224"]=t.sha512.sha224,i.create=function(i){if(s||e(),"undefined"==typeof i&&(i="SHA-512"),!(i in u))throw new Error("Invalid SHA-512 algorithm: "+i);for(var n=u[i],o=null,c=t.util.createBuffer(),l=new Array(80),f=0;80>f;++f)l[f]=new Array(2);var p={algorithm:i.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]};return p.start=function(){p.messageLength=0,p.messageLength128=[0,0,0,0],c=t.util.createBuffer(),o=new Array(n.length);for(var e=0;e<n.length;++e)o[e]=n[e].slice(0);return p},p.start(),p.update=function(e,i){"utf8"===i&&(e=t.util.encodeUtf8(e)),p.messageLength+=e.length;var n=e.length;n=[n/4294967296>>>0,n>>>0];for(var a=3;a>=0;--a)p.messageLength128[a]+=n[1],n[1]=n[0]+(p.messageLength128[a]/4294967296>>>0),p.messageLength128[a]=p.messageLength128[a]>>>0,n[0]=n[1]/4294967296>>>0;return c.putBytes(e),r(o,l,c),(c.read>2048||0===c.length())&&c.compact(),p},p.digest=function(){var e=t.util.createBuffer();e.putBytes(c.bytes()),e.putBytes(a.substr(0,128-(p.messageLength128[3]+16&127)));for(var n=[],s=0;3>s;++s)n[s]=p.messageLength128[s]<<3|p.messageLength128[s-1]>>>28;n[3]=p.messageLength128[3]<<3,e.putInt32(n[0]),e.putInt32(n[1]),e.putInt32(n[2]),e.putInt32(n[3]);for(var u=new Array(o.length),s=0;s<o.length;++s)u[s]=o[s].slice(0);r(u,l,e);var f,h=t.util.createBuffer();f="SHA-512"===i?u.length:"SHA-384"===i?u.length-2:u.length-4;for(var s=0;f>s;++s)h.putInt32(u[s][0]),(s!==f-1||"SHA-512/224"!==i)&&h.putInt32(u[s][1]);return h},p};var a=null,s=!1,o=null,u=null}var i="sha512";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha512",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){t.md=t.md||{},t.md.algorithms={md5:t.md5,sha1:t.sha1,sha256:t.sha256},t.md.md5=t.md5,t.md.sha1=t.sha1,t.md.sha256=t.sha256}var i="md";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){var e=t.hmac=t.hmac||{};e.create=function(){var e=null,r=null,i=null,n=null,a={};return a.start=function(a,s){if(null!==a)if("string"==typeof a){if(a=a.toLowerCase(),!(a in t.md.algorithms))throw new Error('Unknown hash algorithm "'+a+'"');r=t.md.algorithms[a].create()}else r=a;if(null===s)s=e;else{if("string"==typeof s)s=t.util.createBuffer(s);else if(t.util.isArray(s)){var o=s;s=t.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>r.blockLength&&(r.start(),r.update(s.bytes()),s=r.digest()),i=t.util.createBuffer(),n=t.util.createBuffer(),c=s.length();for(var u=0;c>u;++u){var o=s.at(u);i.putByte(54^o),n.putByte(92^o)}if(c<r.blockLength)for(var o=r.blockLength-c,u=0;o>u;++u)i.putByte(54),n.putByte(92);e=s,i=i.bytes(),n=n.bytes()}r.start(),r.update(i)},a.update=function(t){r.update(t)},a.getMac=function(){var t=r.digest().bytes();return r.start(),r.update(n),r.update(t),r.digest()},a.digest=a.getMac,a}}var i="hmac";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(t){for(var e=t.name+": ",r=[],i=function(t,e){return" "+e},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+"\r\n";for(var a=0,s=-1,n=0;n<e.length;++n,++a)if(a>65&&-1!==s){var o=e[s];","===o?(++s,e=e.substr(0,s)+"\r\n "+e.substr(s)):e=e.substr(0,s)+"\r\n"+o+e.substr(s+1),a=n-s-1,s=-1,++n}else(" "===e[n]||"	"===e[n]||","===e[n])&&(s=n);return e}function r(t){return t.replace(/^\s+/,"")}var i=t.pem=t.pem||{};i.encode=function(r,i){i=i||{};var n,a="-----BEGIN "+r.type+"-----\r\n";if(r.procType&&(n={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},a+=e(n)),r.contentDomain&&(n={name:"Content-Domain",values:[r.contentDomain]},a+=e(n)),r.dekInfo&&(n={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&n.values.push(r.dekInfo.parameters),a+=e(n)),r.headers)for(var s=0;s<r.headers.length;++s)a+=e(r.headers[s]);return r.procType&&(a+="\r\n"),a+=t.util.encode64(r.body,i.maxline||64)+"\r\n",a+="-----END "+r.type+"-----\r\n"},i.decode=function(e){for(var i,n=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;;){if(i=a.exec(e),!i)break;var u={type:i[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:t.util.decode64(i[3])};if(n.push(u),i[2]){for(var c=i[2].split(o),l=0;i&&l<c.length;){for(var f=c[l].replace(/\s+$/,""),p=l+1;p<c.length;++p){var h=c[p];if(!/\s/.test(h[0]))break;f+=h,l=p}if(i=f.match(s)){for(var d={name:i[1],values:[]},y=i[2].split(","),g=0;g<y.length;++g)d.values.push(r(y[g]));if(u.procType)if(u.contentDomain||"Content-Domain"!==d.name)if(u.dekInfo||"DEK-Info"!==d.name)u.headers.push(d);else{if(0===d.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:y[0],parameters:y[1]||null}}else u.contentDomain=y[0]||"";else{if("Proc-Type"!==d.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==d.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:y[0],type:y[1]}}}++l}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===n.length)throw new Error("Invalid PEM formatted message.");return n}}var i="pem";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){var r,i=t.pkcs5=t.pkcs5||{},n="undefined"!=typeof process&&process.versions&&process.versions.node;n&&!t.disableNativeCode&&(r=e("crypto")),t.pbkdf2=i.pbkdf2=function(e,i,a,s,o,u){function c(){return E>h?u(null,C):(y.start(null,null),y.update(i),y.update(t.util.int32ToBytes(E)),g=v=y.digest().getBytes(),S=2,void l())}function l(){return a>=S?(y.start(null,null),y.update(v),m=y.digest().getBytes(),g=t.util.xorBytes(g,m,f),v=m,++S,t.util.setImmediate(l)):(C+=h>E?g:g.substr(0,d),++E,void c())}if("function"==typeof o&&(u=o,o=null),n&&!t.disableNativeCode&&r.pbkdf2&&(null===o||"object"!=typeof o)&&(r.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!=typeof o&&(o="sha1"),i=new Buffer(i,"binary"),u?4===r.pbkdf2Sync.length?r.pbkdf2(e,i,a,s,function(t,e){return t?u(t):void u(null,e.toString("binary"))}):r.pbkdf2(e,i,a,s,o,function(t,e){return t?u(t):void u(null,e.toString("binary"))}):4===r.pbkdf2Sync.length?r.pbkdf2Sync(e,i,a,s).toString("binary"):r.pbkdf2Sync(e,i,a,s,o).toString("binary");if(("undefined"==typeof o||null===o)&&(o=t.md.sha1.create()),"string"==typeof o){if(!(o in t.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=t.md[o].create()}var f=o.digestLength;if(s>4294967295*f){var p=new Error("Derived key is too long.");if(u)return u(p);throw p}var h=Math.ceil(s/f),d=s-(h-1)*f,y=t.hmac.create();y.start(o,e);var g,m,v,C="";if(!u){for(var E=1;h>=E;++E){y.start(null,null),y.update(i),y.update(t.util.int32ToBytes(E)),g=v=y.digest().getBytes();for(var S=2;a>=S;++S)y.start(null,null),y.update(v),m=y.digest().getBytes(),g=t.util.xorBytes(g,m,f),v=m;C+=h>E?g:g.substr(0,d)}return C}var S,E=1;c()}}var i="pbkdf2";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){var r="undefined"!=typeof process&&process.versions&&process.versions.node,i=null;t.disableNativeCode||!r||process.versions["node-webkit"]||(i=e("crypto"));var n=t.prng=t.prng||{};n.create=function(e){function r(t){if(o.pools[0].messageLength>=32)return a(),t();var e=32-o.pools[0].messageLength<<5;o.seedFile(e,function(e,r){return e?t(e):(o.collect(r),a(),void t())})}function n(){if(o.pools[0].messageLength>=32)return a();var t=32-o.pools[0].messageLength<<5;o.collect(o.seedFileSync(t)),a()}function a(){var t=o.plugin.md.create();t.update(o.pools[0].digest().getBytes()),o.pools[0].start();for(var e=1,r=1;32>r;++r)e=31===e?2147483648:e<<2,e%o.reseeds===0&&(t.update(o.pools[r].digest().getBytes()),o.pools[r].start());var i=t.digest().getBytes();t.start(),t.update(i);var n=t.digest().getBytes();o.key=o.plugin.formatKey(i),o.seed=o.plugin.formatSeed(n),o.reseeds=4294967295===o.reseeds?0:o.reseeds+1,o.generated=0}function s(e){var r=null;if("undefined"!=typeof window){var i=window.crypto||window.msCrypto;i&&i.getRandomValues&&(r=function(t){return i.getRandomValues(t)})}var n=t.util.createBuffer();if(r)for(;n.length()<e;){var a=Math.max(1,Math.min(e-n.length(),65536)/4),s=new Uint32Array(Math.floor(a));try{r(s);for(var o=0;o<s.length;++o)n.putInt32(s[o])}catch(u){if(!("undefined"!=typeof QuotaExceededError&&u instanceof QuotaExceededError))throw u}}if(n.length()<e)for(var c,l,f,p=Math.floor(65536*Math.random());n.length()<e;){l=16807*(65535&p),c=16807*(p>>16),l+=(32767&c)<<16,l+=c>>15,l=(2147483647&l)+(l>>31),p=4294967295&l;for(var o=0;3>o;++o)f=p>>>(o<<3),f^=Math.floor(256*Math.random()),n.putByte(String.fromCharCode(255&f))}return n.getBytes(e)}for(var o={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0},u=e.md,c=new Array(32),l=0;32>l;++l)c[l]=u.create();return o.pools=c,o.pool=0,o.generate=function(e,i){function n(f){if(f)return i(f);if(l.length()>=e)return i(null,l.getBytes(e));if(o.generated>1048575&&(o.key=null),null===o.key)return t.util.nextTick(function(){r(n)});var p=a(o.key,o.seed);o.generated+=p.length,l.putBytes(p),o.key=u(a(o.key,s(o.seed))),o.seed=c(a(o.key,o.seed)),t.util.setImmediate(n)}if(!i)return o.generateSync(e);var a=o.plugin.cipher,s=o.plugin.increment,u=o.plugin.formatKey,c=o.plugin.formatSeed,l=t.util.createBuffer();o.key=null,n()},o.generateSync=function(e){var r=o.plugin.cipher,i=o.plugin.increment,a=o.plugin.formatKey,s=o.plugin.formatSeed;o.key=null;for(var u=t.util.createBuffer();u.length()<e;){o.generated>1048575&&(o.key=null),null===o.key&&n();var c=r(o.key,o.seed);o.generated+=c.length,u.putBytes(c),o.key=a(r(o.key,i(o.seed))),o.seed=s(r(o.key,o.seed))}return u.getBytes(e)},i?(o.seedFile=function(t,e){i.randomBytes(t,function(t,r){return t?e(t):void e(null,r.toString())})},o.seedFileSync=function(t){return i.randomBytes(t).toString()}):(o.seedFile=function(t,e){try{e(null,s(t))}catch(r){e(r)}},o.seedFileSync=s),o.collect=function(t){for(var e=t.length,r=0;e>r;++r)o.pools[o.pool].update(t.substr(r,1)),o.pool=31===o.pool?0:o.pool+1},o.collectInt=function(t,e){for(var r="",i=0;e>i;i+=8)r+=String.fromCharCode(t>>i&255);o.collect(r)},o.registerWorker=function(t){if(t===self)o.seedFile=function(t,e){function r(t){var i=t.data;i.forge&&i.forge.prng&&(self.removeEventListener("message",r),e(i.forge.prng.err,i.forge.prng.bytes))}self.addEventListener("message",r),self.postMessage({forge:{prng:{needed:t}}})};else{var e=function(e){var r=e.data;r.forge&&r.forge.prng&&o.seedFile(r.forge.prng.needed,function(e,r){t.postMessage({forge:{prng:{err:e,bytes:r}}})})};t.addEventListener("message",e)}},o}}var i="prng";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){t.random&&t.random.getBytes||!function(e){function r(){var e=t.prng.create(i);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}var i={},n=new Array(4),a=t.util.createBuffer();i.formatKey=function(e){var r=t.util.createBuffer(e);return e=new Array(4),e[0]=r.getInt32(),e[1]=r.getInt32(),e[2]=r.getInt32(),e[3]=r.getInt32(),t.aes._expandKey(e,!1)},i.formatSeed=function(e){var r=t.util.createBuffer(e);return e=new Array(4),e[0]=r.getInt32(),e[1]=r.getInt32(),e[2]=r.getInt32(),e[3]=r.getInt32(),e},i.cipher=function(e,r){return t.aes._updateBlock(e,r,n,!1),a.putInt32(n[0]),a.putInt32(n[1]),a.putInt32(n[2]),a.putInt32(n[3]),a.getBytes()},i.increment=function(t){return++t[3],t},i.md=t.md.sha256;var s=r(),o="undefined"!=typeof process&&process.versions&&process.versions.node,u=null;if("undefined"!=typeof window){var c=window.crypto||window.msCrypto;c&&c.getRandomValues&&(u=function(t){return c.getRandomValues(t)})}if(t.disableNativeCode||!o&&!u){if("undefined"==typeof window||void 0===window.document,s.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var f in navigator)try{"string"==typeof navigator[f]&&(l+=navigator[f])}catch(p){}s.collect(l),l=null}e&&(e().mousemove(function(t){s.collectInt(t.clientX,16),s.collectInt(t.clientY,16)}),e().keypress(function(t){s.collectInt(t.charCode,8)}))}if(t.random)for(var f in s)t.random[f]=s[f];else t.random=s;t.random.createInstance=r}("undefined"!=typeof jQuery?jQuery:null)}var i="random";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(t,e,r){this.data=[],null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function r(){return new e(null)}function i(t,e,r,i,n,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[i]+n;n=Math.floor(s/67108864),
  r.data[i++]=67108863&s}return n}function n(t,e,r,i,n,a){for(var s=32767&e,o=e>>15;--a>=0;){var u=32767&this.data[t],c=this.data[t++]>>15,l=o*u+c*s;u=s*u+((32767&l)<<15)+r.data[i]+(1073741823&n),n=(u>>>30)+(l>>>15)+o*c+(n>>>30),r.data[i++]=1073741823&u}return n}function a(t,e,r,i,n,a){for(var s=16383&e,o=e>>14;--a>=0;){var u=16383&this.data[t],c=this.data[t++]>>14,l=o*u+c*s;u=s*u+((16383&l)<<14)+r.data[i]+n,n=(u>>28)+(l>>14)+o*c,r.data[i++]=268435455&u}return n}function s(t){return ae.charAt(t)}function o(t,e){var r=se[t.charCodeAt(e)];return null==r?-1:r}function u(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function c(t){this.t=1,this.s=0>t?-1:0,t>0?this.data[0]=t:-1>t?this.data[0]=t+this.DV:this.t=0}function l(t){var e=r();return e.fromInt(t),e}function f(t,r){var i;if(16==r)i=4;else if(8==r)i=3;else if(256==r)i=8;else if(2==r)i=1;else if(32==r)i=5;else{if(4!=r)return void this.fromRadix(t,r);i=2}this.t=0,this.s=0;for(var n=t.length,a=!1,s=0;--n>=0;){var u=8==i?255&t[n]:o(t,n);0>u?"-"==t.charAt(n)&&(a=!0):(a=!1,0==s?this.data[this.t++]=u:s+i>this.DB?(this.data[this.t-1]|=(u&(1<<this.DB-s)-1)<<s,this.data[this.t++]=u>>this.DB-s):this.data[this.t-1]|=u<<s,s+=i,s>=this.DB&&(s-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),a&&e.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function h(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,a="",o=this.t,u=this.DB-o*this.DB%e;if(o-- >0)for(u<this.DB&&(r=this.data[o]>>u)>0&&(n=!0,a=s(r));o>=0;)e>u?(r=(this.data[o]&(1<<u)-1)<<e-u,r|=this.data[--o]>>(u+=this.DB-e)):(r=this.data[o]>>(u-=e)&i,0>=u&&(u+=this.DB,--o)),r>0&&(n=!0),n&&(a+=s(r));return n?a:"0"}function d(){var t=r();return e.ZERO.subTo(this,t),t}function y(){return this.s<0?this.negate():this}function g(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this.data[r]-t.data[r]))return e;return 0}function m(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function v(){return this.t<=0?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)}function C(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function E(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function S(t,e){var r,i=t%this.DB,n=this.DB-i,a=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e.data[r+s+1]=this.data[r]>>n|o,o=(this.data[r]&a)<<i;for(r=s-1;r>=0;--r)e.data[r]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function T(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var i=t%this.DB,n=this.DB-i,a=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<n,e.data[s-r]=this.data[s]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&a)<<n),e.t=this.t-r,e.clamp()}function I(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);n>r;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=0>i?-1:0,-1>i?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function A(t,r){var i=this.abs(),n=t.abs(),a=i.t;for(r.t=a+n.t;--a>=0;)r.data[a]=0;for(a=0;a<n.t;++a)r.data[a+i.t]=i.am(0,n.data[a],r,a,0,i.t);r.s=0,r.clamp(),this.s!=t.s&&e.ZERO.subTo(r,r)}function b(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function B(t,i,n){var a=t.abs();if(!(a.t<=0)){var s=this.abs();if(s.t<a.t)return null!=i&&i.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=r());var o=r(),u=this.s,c=t.s,l=this.DB-m(a.data[a.t-1]);l>0?(a.lShiftTo(l,o),s.lShiftTo(l,n)):(a.copyTo(o),s.copyTo(n));var f=o.t,p=o.data[f-1];if(0!=p){var h=p*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),d=this.FV/h,y=(1<<this.F1)/h,g=1<<this.F2,v=n.t,C=v-f,E=null==i?r():i;for(o.dlShiftTo(C,E),n.compareTo(E)>=0&&(n.data[n.t++]=1,n.subTo(E,n)),e.ONE.dlShiftTo(f,E),E.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--C>=0;){var S=n.data[--v]==p?this.DM:Math.floor(n.data[v]*d+(n.data[v-1]+g)*y);if((n.data[v]+=o.am(0,S,n,C,0,f))<S)for(o.dlShiftTo(C,E),n.subTo(E,n);n.data[v]<--S;)n.subTo(E,n)}null!=i&&(n.drShiftTo(f,i),u!=c&&e.ZERO.subTo(i,i)),n.t=f,n.clamp(),l>0&&n.rShiftTo(l,n),0>u&&e.ZERO.subTo(n,n)}}}function N(t){var i=r();return this.abs().divRemTo(t,null,i),this.s<0&&i.compareTo(e.ZERO)>0&&t.subTo(i,i),i}function R(t){this.m=t}function w(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function U(t){return t}function L(t){t.divRemTo(this.m,null,t)}function k(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function D(t,e){t.squareTo(e),this.reduce(e)}function O(){if(this.t<1)return 0;var t=this.data[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function P(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function _(t){var i=r();return t.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),t.s<0&&i.compareTo(e.ZERO)>0&&this.m.subTo(i,i),i}function V(t){var e=r();return t.copyTo(e),this.reduce(e),e}function x(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t.data[e],i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function K(t,e){t.squareTo(e),this.reduce(e)}function j(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function q(){return 0==(this.t>0?1&this.data[0]:this.s)}function M(t,i){if(t>4294967295||1>t)return e.ONE;var n=r(),a=r(),s=i.convert(this),o=m(t)-1;for(s.copyTo(n);--o>=0;)if(i.sqrTo(n,a),(t&1<<o)>0)i.mulTo(a,s,n);else{var u=n;n=a,a=u}return i.revert(n)}function F(t,e){var r;return r=256>t||e.isEven()?new R(e):new P(e),this.exp(t,r)}function G(){var t=r();return this.copyTo(t),t}function z(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Q(){return 0==this.t?this.s:this.data[0]<<24>>24}function H(){return 0==this.t?this.s:this.data[0]<<16>>16}function X(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function Y(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=l(i),a=r(),s=r(),o="";for(this.divRemTo(n,a,s);a.signum()>0;)o=(i+s.intValue()).toString(t).substr(1)+o,a.divRemTo(n,a,s);return s.intValue().toString(t)+o}function Z(t,r){this.fromInt(0),null==r&&(r=10);for(var i=this.chunkSize(r),n=Math.pow(r,i),a=!1,s=0,u=0,c=0;c<t.length;++c){var l=o(t,c);0>l?"-"==t.charAt(c)&&0==this.signum()&&(a=!0):(u=r*u+l,++s>=i&&(this.dMultiply(n),this.dAddOffset(u,0),s=0,u=0))}s>0&&(this.dMultiply(Math.pow(r,s)),this.dAddOffset(u,0)),a&&e.ZERO.subTo(this,this)}function J(t,r,i){if("number"==typeof r)if(2>t)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),st,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var n=new Array,a=7&t;n.length=(t>>3)+1,r.nextBytes(n),a>0?n[0]&=(1<<a)-1:n[0]=0,this.fromString(n,256)}}function $(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(t-- >0)for(i<this.DB&&(r=this.data[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);t>=0;)8>i?(r=(this.data[t]&(1<<i)-1)<<8-i,r|=this.data[--t]>>(i+=this.DB-8)):(r=this.data[t]>>(i-=8)&255,0>=i&&(i+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e}function tt(t){return 0==this.compareTo(t)}function et(t){return this.compareTo(t)<0?this:t}function rt(t){return this.compareTo(t)>0?this:t}function it(t,e,r){var i,n,a=Math.min(t.t,this.t);for(i=0;a>i;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=a;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=a;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function nt(t,e){return t&e}function at(t){var e=r();return this.bitwiseTo(t,nt,e),e}function st(t,e){return t|e}function ot(t){var e=r();return this.bitwiseTo(t,st,e),e}function ut(t,e){return t^e}function ct(t){var e=r();return this.bitwiseTo(t,ut,e),e}function lt(t,e){return t&~e}function ft(t){var e=r();return this.bitwiseTo(t,lt,e),e}function pt(){for(var t=r(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function ht(t){var e=r();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function dt(t){var e=r();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function yt(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function gt(){for(var t=0;t<this.t;++t)if(0!=this.data[t])return t*this.DB+yt(this.data[t]);return this.s<0?this.t*this.DB:-1}function mt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function vt(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=mt(this.data[r]^e);return t}function Ct(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this.data[e]&1<<t%this.DB)}function Et(t,r){var i=e.ONE.shiftLeft(t);return this.bitwiseTo(i,r,i),i}function St(t){return this.changeBit(t,st)}function Tt(t){return this.changeBit(t,lt)}function It(t){return this.changeBit(t,ut)}function At(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);n>r;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=0>i?-1:0,i>0?e.data[r++]=i:-1>i&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function bt(t){var e=r();return this.addTo(t,e),e}function Bt(t){var e=r();return this.subTo(t,e),e}function Nt(t){var e=r();return this.multiplyTo(t,e),e}function Rt(t){var e=r();return this.divRemTo(t,e,null),e}function wt(t){var e=r();return this.divRemTo(t,null,e),e}function Ut(t){var e=r(),i=r();return this.divRemTo(t,e,i),new Array(e,i)}function Lt(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function kt(t,e){if(0!=t){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Dt(){}function Ot(t){return t}function Pt(t,e,r){t.multiplyTo(e,r)}function _t(t,e){t.squareTo(e)}function Vt(t){return this.exp(t,new Dt)}function xt(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;n>i;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);n>i;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function Kt(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function jt(t){this.r2=r(),this.q3=r(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function qt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=r();return t.copyTo(e),this.reduce(e),e}function Mt(t){return t}function Ft(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Gt(t,e){t.squareTo(e),this.reduce(e)}function zt(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Qt(t,e){var i,n,a=t.bitLength(),s=l(1);if(0>=a)return s;i=18>a?1:48>a?3:144>a?4:768>a?5:6,n=8>a?new R(e):e.isEven()?new jt(e):new P(e);var o=new Array,u=3,c=i-1,f=(1<<i)-1;if(o[1]=n.convert(this),i>1){var p=r();for(n.sqrTo(o[1],p);f>=u;)o[u]=r(),n.mulTo(p,o[u-2],o[u]),u+=2}var h,d,y=t.t-1,g=!0,v=r();for(a=m(t.data[y])-1;y>=0;){for(a>=c?h=t.data[y]>>a-c&f:(h=(t.data[y]&(1<<a+1)-1)<<c-a,y>0&&(h|=t.data[y-1]>>this.DB+a-c)),u=i;0==(1&h);)h>>=1,--u;if((a-=u)<0&&(a+=this.DB,--y),g)o[h].copyTo(s),g=!1;else{for(;u>1;)n.sqrTo(s,v),n.sqrTo(v,s),u-=2;u>0?n.sqrTo(s,v):(d=s,s=v,v=d),n.mulTo(v,o[h],s)}for(;y>=0&&0==(t.data[y]&1<<a);)n.sqrTo(s,v),d=s,s=v,v=d,--a<0&&(a=this.DB-1,--y)}return n.revert(s)}function Ht(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),a=r.getLowestSetBit();if(0>a)return e;for(a>n&&(a=n),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Xt(t){if(0>=t)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function Wt(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return e.ZERO;for(var i=t.clone(),n=this.clone(),a=l(1),s=l(0),o=l(0),u=l(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),r?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(t,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),r?(o.isEven()&&u.isEven()||(o.addTo(this,o),u.subTo(t,u)),o.rShiftTo(1,o)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);i.compareTo(n)>=0?(i.subTo(n,i),r&&a.subTo(o,a),s.subTo(u,s)):(n.subTo(i,n),r&&o.subTo(a,o),u.subTo(s,u))}return 0!=n.compareTo(e.ONE)?e.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u}function Yt(t){var e,r=this.abs();if(1==r.t&&r.data[0]<=oe[oe.length-1]){for(e=0;e<oe.length;++e)if(r.data[0]==oe[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<oe.length;){for(var i=oe[e],n=e+1;n<oe.length&&ue>i;)i*=oe[n++];for(i=r.modInt(i);n>e;)if(i%oe[e++]==0)return!1}return r.millerRabin(t)}function Zt(t){var r=this.subtract(e.ONE),i=r.getLowestSetBit();if(0>=i)return!1;for(var n,a=r.shiftRight(i),s=Jt(),o=0;t>o;++o){do n=new e(this.bitLength(),s);while(n.compareTo(e.ONE)<=0||n.compareTo(r)>=0);var u=n.modPow(a,this);if(0!=u.compareTo(e.ONE)&&0!=u.compareTo(r)){for(var c=1;c++<i&&0!=u.compareTo(r);)if(u=u.modPowInt(2,this),0==u.compareTo(e.ONE))return!1;if(0!=u.compareTo(r))return!1}}return!0}function Jt(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(256*Math.random())}}}var $t,te=0xdeadbeefcafe,ee=15715070==(16777215&te);"undefined"==typeof navigator?(e.prototype.am=a,$t=28):ee&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=n,$t=30):ee&&"Netscape"!=navigator.appName?(e.prototype.am=i,$t=26):(e.prototype.am=a,$t=28),e.prototype.DB=$t,e.prototype.DM=(1<<$t)-1,e.prototype.DV=1<<$t;var re=52;e.prototype.FV=Math.pow(2,re),e.prototype.F1=re-$t,e.prototype.F2=2*$t-re;var ie,ne,ae="0123456789abcdefghijklmnopqrstuvwxyz",se=new Array;for(ie="0".charCodeAt(0),ne=0;9>=ne;++ne)se[ie++]=ne;for(ie="a".charCodeAt(0),ne=10;36>ne;++ne)se[ie++]=ne;for(ie="A".charCodeAt(0),ne=10;36>ne;++ne)se[ie++]=ne;R.prototype.convert=w,R.prototype.revert=U,R.prototype.reduce=L,R.prototype.mulTo=k,R.prototype.sqrTo=D,P.prototype.convert=_,P.prototype.revert=V,P.prototype.reduce=x,P.prototype.mulTo=j,P.prototype.sqrTo=K,e.prototype.copyTo=u,e.prototype.fromInt=c,e.prototype.fromString=f,e.prototype.clamp=p,e.prototype.dlShiftTo=C,e.prototype.drShiftTo=E,e.prototype.lShiftTo=S,e.prototype.rShiftTo=T,e.prototype.subTo=I,e.prototype.multiplyTo=A,e.prototype.squareTo=b,e.prototype.divRemTo=B,e.prototype.invDigit=O,e.prototype.isEven=q,e.prototype.exp=M,e.prototype.toString=h,e.prototype.negate=d,e.prototype.abs=y,e.prototype.compareTo=g,e.prototype.bitLength=v,e.prototype.mod=N,e.prototype.modPowInt=F,e.ZERO=l(0),e.ONE=l(1),Dt.prototype.convert=Ot,Dt.prototype.revert=Ot,Dt.prototype.mulTo=Pt,Dt.prototype.sqrTo=_t,jt.prototype.convert=qt,jt.prototype.revert=Mt,jt.prototype.reduce=Ft,jt.prototype.mulTo=zt,jt.prototype.sqrTo=Gt;var oe=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ue=(1<<26)/oe[oe.length-1];e.prototype.chunkSize=X,e.prototype.toRadix=Y,e.prototype.fromRadix=Z,e.prototype.fromNumber=J,e.prototype.bitwiseTo=it,e.prototype.changeBit=Et,e.prototype.addTo=At,e.prototype.dMultiply=Lt,e.prototype.dAddOffset=kt,e.prototype.multiplyLowerTo=xt,e.prototype.multiplyUpperTo=Kt,e.prototype.modInt=Xt,e.prototype.millerRabin=Zt,e.prototype.clone=G,e.prototype.intValue=z,e.prototype.byteValue=Q,e.prototype.shortValue=H,e.prototype.signum=W,e.prototype.toByteArray=$,e.prototype.equals=tt,e.prototype.min=et,e.prototype.max=rt,e.prototype.and=at,e.prototype.or=ot,e.prototype.xor=ct,e.prototype.andNot=ft,e.prototype.not=pt,e.prototype.shiftLeft=ht,e.prototype.shiftRight=dt,e.prototype.getLowestSetBit=gt,e.prototype.bitCount=vt,e.prototype.testBit=Ct,e.prototype.setBit=St,e.prototype.clearBit=Tt,e.prototype.flipBit=It,e.prototype.add=bt,e.prototype.subtract=Bt,e.prototype.multiply=Nt,e.prototype.divide=Rt,e.prototype.remainder=wt,e.prototype.divideAndRemainder=Ut,e.prototype.modPow=Qt,e.prototype.modInverse=Wt,e.prototype.pow=Vt,e.prototype.gcd=Ht,e.prototype.isProbablePrime=Yt,t.jsbn=t.jsbn||{},t.jsbn.BigInteger=e}var i="jsbn";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(e,r,i){i||(i=t.md.sha1.create());for(var n="",a=Math.ceil(r/i.digestLength),s=0;a>s;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);i.start(),i.update(e+o),n+=i.digest().getBytes()}return n.substring(0,r)}var r=t.pkcs1=t.pkcs1||{};r.encode_rsa_oaep=function(r,i,n){var a,s,o,u;"string"==typeof n?(a=n,s=arguments[3]||void 0,o=arguments[4]||void 0):n&&(a=n.label||void 0,s=n.seed||void 0,o=n.md||void 0,n.mgf1&&n.mgf1.md&&(u=n.mgf1.md)),o?o.start():o=t.md.sha1.create(),u||(u=o);var c=Math.ceil(r.n.bitLength()/8),l=c-2*o.digestLength-2;if(i.length>l){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=i.length,f.maxLength=l,f}a||(a=""),o.update(a,"raw");for(var p=o.digest(),h="",d=l-i.length,y=0;d>y;y++)h+="\x00";var g=p.getBytes()+h+""+i;if(s){if(s.length!==o.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=s.length,f.digestLength=o.digestLength,f}}else s=t.random.getBytes(o.digestLength);var m=e(s,c-o.digestLength-1,u),v=t.util.xorBytes(g,m,g.length),C=e(v,o.digestLength,u),E=t.util.xorBytes(s,C,s.length);return"\x00"+E+v},r.decode_rsa_oaep=function(r,i,n){var a,s,o;"string"==typeof n?(a=n,s=arguments[3]||void 0):n&&(a=n.label||void 0,s=n.md||void 0,n.mgf1&&n.mgf1.md&&(o=n.mgf1.md));var u=Math.ceil(r.n.bitLength()/8);if(i.length!==u){var c=new Error("RSAES-OAEP encoded message length is invalid.");throw c.length=i.length,c.expectedLength=u,c}if(void 0===s?s=t.md.sha1.create():s.start(),o||(o=s),u<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");a||(a=""),s.update(a,"raw");for(var l=s.digest().getBytes(),f=i.charAt(0),p=i.substring(1,s.digestLength+1),h=i.substring(1+s.digestLength),d=e(h,s.digestLength,o),y=t.util.xorBytes(p,d,p.length),g=e(y,u-s.digestLength-1,o),m=t.util.xorBytes(h,g,h.length),v=m.substring(0,s.digestLength),c="\x00"!==f,C=0;C<s.digestLength;++C)c|=l.charAt(C)!==v.charAt(C);for(var E=1,S=s.digestLength,T=s.digestLength;T<m.length;T++){var I=m.charCodeAt(T),A=1&I^1,b=E?65534:0;c|=I&b,E&=A,S+=E}if(c||1!==m.charCodeAt(S))throw new Error("Invalid RSAES-OAEP padding.");return m.substring(S+1)}}var i="pkcs1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(t,e,n,a){return"workers"in n?i(t,e,n,a):r(t,e,n,a)}function r(e,i,s,o){var c=n(e,i),l=0,f=a(c.bitLength());"millerRabinTests"in s&&(f=s.millerRabinTests);var p=10;"maxBlockTime"in s&&(p=s.maxBlockTime);var h=+new Date;do{if(c.bitLength()>e&&(c=n(e,i)),c.isProbablePrime(f))return o(null,c);c.dAddOffset(u[l++%8],0)}while(0>p||+new Date-h<p);t.util.setImmediate(function(){r(e,i,s,o)})}function i(e,i,a,s){function u(){function t(t){if(!d){--u;var a=t.data;if(a.found){for(var l=0;l<r.length;++l)r[l].terminate();return d=!0,s(null,new o(a.prime,16))}c.bitLength()>e&&(c=n(e,i));var h=c.toString(16);t.target.postMessage({hex:h,workLoad:f}),c.dAddOffset(p,0)}}l=Math.max(1,l);for(var r=[],a=0;l>a;++a)r[a]=new Worker(h);for(var u=l,a=0;l>a;++a)r[a].addEventListener("message",t);var d=!1}if("undefined"==typeof Worker)return r(e,i,a,s);var c=n(e,i),l=a.workers,f=a.workLoad||100,p=30*f/8,h=a.workerScript||"forge/prime.worker.js";return-1===l?t.util.estimateCores(function(t,e){t&&(e=2),l=e-1,u()}):void u()}function n(t,e){var r=new o(t,e),i=t-1;return r.testBit(i)||r.bitwiseTo(o.ONE.shiftLeft(i),l,r),r.dAddOffset(31-r.mod(c).byteValue(),0),r}function a(t){return 100>=t?27:150>=t?18:200>=t?15:250>=t?12:300>=t?9:350>=t?8:400>=t?7:500>=t?6:600>=t?5:800>=t?4:1250>=t?3:2}if(!t.prime){var s=t.prime=t.prime||{},o=t.jsbn.BigInteger,u=[6,4,2,4,2,4,6,2],c=new o(null);c.fromInt(30);var l=function(t,e){return t|e};s.generateProbablePrime=function(r,i,n){"function"==typeof i&&(n=i,i={}),i=i||{};var a=i.algorithm||"PRIMEINC";"string"==typeof a&&(a={name:a}),a.options=a.options||{};var s=i.prng||t.random,o={nextBytes:function(t){for(var e=s.getBytesSync(t.length),r=0;r<t.length;++r)t[r]=e.charCodeAt(r)}};if("PRIMEINC"===a.name)return e(r,o,a.options,n);throw new Error("Invalid prime generation algorithm: "+a.name)}}}var i="prime";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prime",["require","module","./util","./jsbn","./random"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(e,r,i){var n=t.util.createBuffer(),a=Math.ceil(r.n.bitLength()/8);if(e.length>a-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=a-11,s}n.putByte(0),n.putByte(i);var o,u=a-3-e.length;if(0===i||1===i){o=0===i?0:255;for(var c=0;u>c;++c)n.putByte(o)}else for(;u>0;){for(var l=0,f=t.random.getBytes(u),c=0;u>c;++c)o=f.charCodeAt(c),0===o?++l:n.putByte(o);u=l}return n.putByte(0),n.putBytes(e),n}function r(e,r,i,n){var a=Math.ceil(r.n.bitLength()/8),s=t.util.createBuffer(e),o=s.getByte(),u=s.getByte();if(0!==o||i&&0!==u&&1!==u||!i&&2!=u||i&&0===u&&"undefined"==typeof n)throw new Error("Encryption block is invalid.");var c=0;if(0===u){c=a-3-n;for(var l=0;c>l;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===u)for(c=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++c}else if(2===u)for(c=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++c}var f=s.getByte();if(0!==f||c!==a-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function i(e,r,i){function n(){a(e.pBits,function(t,r){return t?i(t):(e.p=r,null!==e.q?o(t,e.q):void a(e.qBits,o))})}function a(e,r){t.prime.generateProbablePrime(e,c,r)}function o(t,r){if(t)return i(t);if(e.q=r,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void n();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void a(e.qBits,o);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void n();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,o);var l=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)},i(null,e.keys)}"function"==typeof r&&(i=r,r={}),r=r||{};var c={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(c.prng=r.prng),n()}function n(e){var r=e.toString(16);return r[0]>="8"&&(r="00"+r),t.util.hexToBytes(r)}function a(t){return 100>=t?27:150>=t?18:200>=t?15:250>=t?12:300>=t?9:350>=t?8:400>=t?7:500>=t?6:600>=t?5:800>=t?4:1250>=t?3:2}if("undefined"==typeof s)var s=t.jsbn.BigInteger;var o=t.asn1;t.pki=t.pki||{},t.pki.rsa=t.rsa=t.rsa||{};var u=t.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},f={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},p={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},h=t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},d=function(t){var e;if(!(t.algorithm in u.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}e=u.oids[t.algorithm];var i=o.oidToDer(e).getBytes(),n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);a.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,i)),a.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var s=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(a),n.value.push(s),o.toDer(n).getBytes()},y=function(e,r,i){if(i)return e.modPow(r.e,r.n);if(!r.p||!r.q)return e.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(s.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(s.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var n;do n=new s(t.util.bytesToHex(t.random.getBytes(r.n.bitLength()/8)),16);while(n.compareTo(r.n)>=0||!n.gcd(r.n).equals(s.ONE));e=e.multiply(n.modPow(r.e,r.n)).mod(r.n);for(var a=e.mod(r.p).modPow(r.dP,r.p),o=e.mod(r.q).modPow(r.dQ,r.q);a.compareTo(o)<0;)a=a.add(r.p);var u=a.subtract(o).multiply(r.qInv).mod(r.p).multiply(r.q).add(o);return u=u.multiply(n.modInverse(r.n)).mod(r.n)};u.rsa.encrypt=function(r,i,n){var a,o=n,u=Math.ceil(i.n.bitLength()/8);n!==!1&&n!==!0?(o=2===n,a=e(r,i,n)):(a=t.util.createBuffer(),a.putBytes(r));for(var c=new s(a.toHex(),16),l=y(c,i,o),f=l.toString(16),p=t.util.createBuffer(),h=u-Math.ceil(f.length/2);h>0;)p.putByte(0),--h;return p.putBytes(t.util.hexToBytes(f)),p.getBytes()},u.rsa.decrypt=function(e,i,n,a){var o=Math.ceil(i.n.bitLength()/8);if(e.length!==o){var u=new Error("Encrypted message length is invalid.");throw u.length=e.length,u.expected=o,u}var c=new s(t.util.createBuffer(e).toHex(),16);if(c.compareTo(i.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=y(c,i,n),f=l.toString(16),p=t.util.createBuffer(),h=o-Math.ceil(f.length/2);h>0;)p.putByte(0),--h;return p.putBytes(t.util.hexToBytes(f)),a!==!1?r(p.getBytes(),i,n):p.getBytes()},u.rsa.createKeyPairGenerationState=function(e,r,i){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048,i=i||{};var n,a=i.prng||t.random,o={
  nextBytes:function(t){for(var e=a.getBytesSync(t.length),r=0;r<t.length;++r)t[r]=e.charCodeAt(r)}},u=i.algorithm||"PRIMEINC";if("PRIMEINC"!==u)throw new Error("Invalid key generation algorithm: "+u);return n={algorithm:u,state:0,bits:e,rng:o,eInt:r||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},n.e.fromInt(n.eInt),n},u.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var i,n=0,o=function(t,e){return t|e},l=+new Date,f=0;null===t.keys&&(0>=e||e>f);){if(0===t.state){var p=null===t.p?t.pBits:t.qBits,h=p-1;0===t.pqState?(t.num=new s(p,t.rng),t.num.testBit(h)||t.num.bitwiseTo(s.ONE.shiftLeft(h),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):1===t.pqState?t.num.bitLength()>p?t.pqState=0:t.num.isProbablePrime(a(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(c[n++%8],0):2===t.pqState?t.pqState=0===t.num.subtract(s.ONE).gcd(t.e).compareTo(s.ONE)?3:0:3===t.pqState&&(t.pqState=0,null===t.p?t.p=t.num:t.q=t.num,null!==t.p&&null!==t.q&&++t.state,t.num=null)}else if(1===t.state)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(2===t.state)t.p1=t.p.subtract(s.ONE),t.q1=t.q.subtract(s.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(3===t.state)0===t.phi.gcd(t.e).compareTo(s.ONE)?++t.state:(t.p=null,t.q=null,t.state=0);else if(4===t.state)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(5===t.state){var d=t.e.modInverse(t.phi);t.keys={privateKey:u.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:u.rsa.setPublicKey(t.n,t.e)}}i=+new Date,f+=i-l,l=i}return null!==t.keys},u.rsa.generateKeyPair=function(t,e,r,n){1===arguments.length?"object"==typeof t?(r=t,t=void 0):"function"==typeof t&&(n=t,t=void 0):2===arguments.length?"number"==typeof t?"function"==typeof e?(n=e,e=void 0):"number"!=typeof e&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):3===arguments.length&&("number"==typeof e?"function"==typeof r&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},void 0===t&&(t=r.bits||2048),void 0===e&&(e=r.e||65537);var a=u.rsa.createKeyPairGenerationState(t,e,r);return n?void i(a,r,n):(u.rsa.stepKeyPairGenerationState(a,0),a.keys)},u.setRsaPublicKey=u.rsa.setPublicKey=function(i,n){var a={n:i,e:n};return a.encrypt=function(r,i,n){if("string"==typeof i?i=i.toUpperCase():void 0===i&&(i="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===i)i={encode:function(t,r,i){return e(t,r,2).getBytes()}};else if("RSA-OAEP"===i||"RSAES-OAEP"===i)i={encode:function(e,r){return t.pkcs1.encode_rsa_oaep(r,e,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(i))i={encode:function(t){return t}};else if("string"==typeof i)throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(r,a,!0);return u.rsa.encrypt(s,a,!0)},a.verify=function(t,e,i){"string"==typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===i?i={verify:function(t,e){e=r(e,a,!0);var i=o.fromDer(e);return t===i.value[1].value}}:("NONE"===i||"NULL"===i||null===i)&&(i={verify:function(t,e){return e=r(e,a,!0),t===e}});var n=u.rsa.decrypt(e,a,!0,!1);return i.verify(t,n,a.n.bitLength())},a},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(e,i,n,a,s,o,c,l){var f={n:e,e:i,d:n,p:a,q:s,dP:o,dQ:c,qInv:l};return f.decrypt=function(e,i,n){"string"==typeof i?i=i.toUpperCase():void 0===i&&(i="RSAES-PKCS1-V1_5");var a=u.rsa.decrypt(e,f,!1,!1);if("RSAES-PKCS1-V1_5"===i)i={decode:r};else if("RSA-OAEP"===i||"RSAES-OAEP"===i)i={decode:function(e,r){return t.pkcs1.decode_rsa_oaep(r,e,n)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(i))throw new Error('Unsupported encryption scheme: "'+i+'".');i={decode:function(t){return t}}}return i.decode(a,f,!1)},f.sign=function(t,e){var r=!1;"string"==typeof e&&(e=e.toUpperCase()),void 0===e||"RSASSA-PKCS1-V1_5"===e?(e={encode:d},r=1):("NONE"===e||"NULL"===e||null===e)&&(e={encode:function(){return t}},r=1);var i=e.encode(t,f.n.bitLength());return u.rsa.encrypt(i,f,r)},f},u.wrapRsaPrivateKey=function(t){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(t).getBytes())])},u.privateKeyFromAsn1=function(e){var r={},i=[];if(o.validate(e,l,r,i)&&(e=o.fromDer(t.util.createBuffer(r.privateKey))),r={},i=[],!o.validate(e,f,r,i)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=i,n}var a,c,p,h,d,y,g,m;return a=t.util.createBuffer(r.privateKeyModulus).toHex(),c=t.util.createBuffer(r.privateKeyPublicExponent).toHex(),p=t.util.createBuffer(r.privateKeyPrivateExponent).toHex(),h=t.util.createBuffer(r.privateKeyPrime1).toHex(),d=t.util.createBuffer(r.privateKeyPrime2).toHex(),y=t.util.createBuffer(r.privateKeyExponent1).toHex(),g=t.util.createBuffer(r.privateKeyExponent2).toHex(),m=t.util.createBuffer(r.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new s(a,16),new s(c,16),new s(p,16),new s(h,16),new s(d,16),new s(y,16),new s(g,16),new s(m,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(t){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.qInv))])},u.publicKeyFromAsn1=function(e){var r={},i=[];if(o.validate(e,h,r,i)){var n=o.derToOid(r.publicKeyOid);if(n!==u.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=n,a}e=r.rsaPublicKey}if(i=[],!o.validate(e,p,r,i)){var a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=i,a}var c=t.util.createBuffer(r.publicKeyModulus).toHex(),l=t.util.createBuffer(r.publicKeyExponent).toHex();return u.setRsaPublicKey(new s(c,16),new s(l,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(t){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(t)])])},u.publicKeyToRSAPublicKey=function(t){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n(t.e))])}}var i="rsa";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(t,e){"string"==typeof e&&(e={shortName:e});for(var r,i=null,n=0;null===i&&n<t.attributes.length;++n)r=t.attributes[n],e.type&&e.type===r.type?i=r:e.name&&e.name===r.name?i=r:e.shortName&&e.shortName===r.shortName&&(i=r);return i}function r(e){for(var r,i,n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=e.attributes,s=0;s<a.length;++s){r=a[s];var u=r.value,c=o.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===o.Type.UTF8&&(u=t.util.encodeUtf8(u))),i=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(r.type).getBytes()),o.create(o.Class.UNIVERSAL,c,!1,u)])]),n.value.push(i)}return n}function i(t){for(var e,r=0;r<t.length;++r){if(e=t[r],"undefined"==typeof e.name&&(e.type&&e.type in u.oids?e.name=u.oids[e.type]:e.shortName&&e.shortName in l&&(e.name=u.oids[l[e.shortName]])),"undefined"==typeof e.type){if(!(e.name&&e.name in u.oids)){var i=new Error("Attribute type not specified.");throw i.attribute=e,i}e.type=u.oids[e.name]}if("undefined"==typeof e.shortName&&e.name&&e.name in l&&(e.shortName=l[e.name]),e.type===c.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=o.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var a=0;a<e.extensions.length;++a)e.value.push(u.certificateExtensionToAsn1(n(e.extensions[a])))}if("undefined"==typeof e.value){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function n(e,r){if(r=r||{},"undefined"==typeof e.name&&e.id&&e.id in u.oids&&(e.name=u.oids[e.id]),"undefined"==typeof e.id){if(!(e.name&&e.name in u.oids)){var i=new Error("Extension ID not specified.");throw i.extension=e,i}e.id=u.oids[e.name]}if("undefined"!=typeof e.value)return e;if("keyUsage"===e.name){var n=0,a=0,s=0;e.digitalSignature&&(a|=128,n=7),e.nonRepudiation&&(a|=64,n=6),e.keyEncipherment&&(a|=32,n=5),e.dataEncipherment&&(a|=16,n=4),e.keyAgreement&&(a|=8,n=3),e.keyCertSign&&(a|=4,n=2),e.cRLSign&&(a|=2,n=1),e.encipherOnly&&(a|=1,n=0),e.decipherOnly&&(s|=128,n=7);var l=String.fromCharCode(n);0!==s?l+=String.fromCharCode(a)+String.fromCharCode(s):0!==a&&(l+=String.fromCharCode(a)),e.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,l)}else if("basicConstraints"===e.name)e.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);var f=e.value.value;for(var p in e)e[p]===!0&&(p in c?f.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c[p]).getBytes())):-1!==p.indexOf(".")&&f.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(p).getBytes())))}else if("nsCertType"===e.name){var n=0,a=0;e.client&&(a|=128,n=7),e.server&&(a|=64,n=6),e.email&&(a|=32,n=5),e.objsign&&(a|=16,n=4),e.reserved&&(a|=8,n=3),e.sslCA&&(a|=4,n=2),e.emailCA&&(a|=2,n=1),e.objCA&&(a|=1,n=0);var l=String.fromCharCode(n);0!==a&&(l+=String.fromCharCode(a)),e.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,l)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);for(var h,d=0;d<e.altNames.length;++d){h=e.altNames[d];var l=h.value;if(7===h.type&&h.ip){if(l=t.util.bytesFromIP(h.ip),null===l){var i=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw i.extension=e,i}}else 8===h.type&&(l=h.oid?o.oidToDer(o.oidToDer(h.oid)):o.oidToDer(l));e.value.value.push(o.create(o.Class.CONTEXT_SPECIFIC,h.type,!1,l))}}else if("subjectKeyIdentifier"===e.name&&r.cert){var y=r.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=y.toHex(),e.value=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,y.getBytes())}if("undefined"==typeof e.value){var i=new Error("Extension value not specified.");throw i.extension=e,i}return e}function a(t,e){switch(t){case c["RSASSA-PSS"]:var r=[];return void 0!==e.hash.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])),void 0!==e.mgf.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.mgf.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.mgf.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])])),void 0!==e.saltLength&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(e.saltLength).getBytes())])),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,r);default:return o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")}}function s(e){var r=o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return r;for(var i=e.attributes,n=0;n<i.length;++n){var a=i[n],s=a.value,u=o.Type.UTF8;"valueTagClass"in a&&(u=a.valueTagClass),u===o.Type.UTF8&&(s=t.util.encodeUtf8(s));var c=!1;"valueConstructed"in a&&(c=a.valueConstructed);var l=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.type).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,u,c,s)])]);r.value.push(l)}return r}var o=t.asn1,u=t.pki=t.pki||{},c=u.oids,l={};l.CN=c.commonName,l.commonName="CN",l.C=c.countryName,l.countryName="C",l.L=c.localityName,l.localityName="L",l.ST=c.stateOrProvinceName,l.stateOrProvinceName="ST",l.O=c.organizationName,l.organizationName="O",l.OU=c.organizationalUnitName,l.organizationalUnitName="OU",l.E=c.emailAddress,l.emailAddress="E";var f=t.pki.rsa.publicKeyValidator,p={name:"Certificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},f,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},h={name:"rsapss",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},d={name:"CertificationRequestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},f,{name:"CertificationRequestInfo.attributes",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0}]}]}]},y={name:"CertificationRequest",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[d,{name:"CertificationRequest.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};u.RDNAttributesAsArray=function(t,e){for(var r,i,n,a=[],s=0;s<t.value.length;++s){r=t.value[s];for(var u=0;u<r.value.length;++u)n={},i=r.value[u],n.type=o.derToOid(i.value[0].value),n.value=i.value[1].value,n.valueTagClass=i.value[1].type,n.type in c&&(n.name=c[n.type],n.name in l&&(n.shortName=l[n.name])),e&&(e.update(n.type),e.update(n.value)),a.push(n)}return a},u.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var i=t[r],n=o.derToOid(i.value[0].value),a=i.value[1].value,s=0;s<a.length;++s){var f={};if(f.type=n,f.value=a[s].value,f.valueTagClass=a[s].type,f.type in c&&(f.name=c[f.type],f.name in l&&(f.shortName=l[f.name])),f.type===c.extensionRequest){f.extensions=[];for(var p=0;p<f.value.length;++p)f.extensions.push(u.certificateExtensionFromAsn1(f.value[p]))}e.push(f)}return e};var g=function(t,e,r){var i={};if(t!==c["RSASSA-PSS"])return i;r&&(i={hash:{algorithmOid:c.sha1},mgf:{algorithmOid:c.mgf1,hash:{algorithmOid:c.sha1}},saltLength:20});var n={},a=[];if(!o.validate(e,h,n,a)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=a,s}return void 0!==n.hashOid&&(i.hash=i.hash||{},i.hash.algorithmOid=o.derToOid(n.hashOid)),void 0!==n.maskGenOid&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=o.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=o.derToOid(n.maskGenHashOid)),void 0!==n.saltLength&&(i.saltLength=n.saltLength.charCodeAt(0)),i};u.certificateFromPem=function(e,r,i){var n=t.pem.decode(e)[0];if("CERTIFICATE"!==n.type&&"X509 CERTIFICATE"!==n.type&&"TRUSTED CERTIFICATE"!==n.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=n.type,a}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=o.fromDer(n.body,i);return u.certificateFromAsn1(s,r)},u.certificateToPem=function(e,r){var i={type:"CERTIFICATE",body:o.toDer(u.certificateToAsn1(e)).getBytes()};return t.pem.encode(i,{maxline:r})},u.publicKeyFromPem=function(e){var r=t.pem.decode(e)[0];if("PUBLIC KEY"!==r.type&&"RSA PUBLIC KEY"!==r.type){var i=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw i.headerType=r.type,i}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=o.fromDer(r.body);return u.publicKeyFromAsn1(n)},u.publicKeyToPem=function(e,r){var i={type:"PUBLIC KEY",body:o.toDer(u.publicKeyToAsn1(e)).getBytes()};return t.pem.encode(i,{maxline:r})},u.publicKeyToRSAPublicKeyPem=function(e,r){var i={type:"RSA PUBLIC KEY",body:o.toDer(u.publicKeyToRSAPublicKey(e)).getBytes()};return t.pem.encode(i,{maxline:r})},u.getPublicKeyFingerprint=function(e,r){r=r||{};var i,n=r.md||t.md.sha1.create(),a=r.type||"RSAPublicKey";switch(a){case"RSAPublicKey":i=o.toDer(u.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=o.toDer(u.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+r.type+'".')}n.start(),n.update(i);var s=n.digest();if("hex"===r.encoding){var c=s.toHex();return r.delimiter?c.match(/.{2}/g).join(r.delimiter):c}if("binary"===r.encoding)return s.getBytes();if(r.encoding)throw new Error('Unknown encoding "'+r.encoding+'".');return s},u.certificationRequestFromPem=function(e,r,i){var n=t.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==n.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=n.type,a}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=o.fromDer(n.body,i);return u.certificationRequestFromAsn1(s,r)},u.certificationRequestToPem=function(e,r){var i={type:"CERTIFICATE REQUEST",body:o.toDer(u.certificationRequestToAsn1(e)).getBytes()};return t.pem.encode(i,{maxline:r})},u.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(t){return e(r.issuer,t)},r.issuer.addField=function(t){i([t]),r.issuer.attributes.push(t)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(t){return e(r.subject,t)},r.subject.addField=function(t){i([t]),r.subject.attributes.push(t)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(t,e){i(t),r.subject.attributes=t,delete r.subject.uniqueId,e&&(r.subject.uniqueId=e),r.subject.hash=null},r.setIssuer=function(t,e){i(t),r.issuer.attributes=t,delete r.issuer.uniqueId,e&&(r.issuer.uniqueId=e),r.issuer.hash=null},r.setExtensions=function(t){for(var e=0;e<t.length;++e)n(t[e],{cert:r});r.extensions=t},r.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var e,i=null,n=0;null===i&&n<r.extensions.length;++n)e=r.extensions[n],t.id&&e.id===t.id?i=e:t.name&&e.name===t.name&&(i=e);return i},r.sign=function(e,i){r.md=i||t.md.sha1.create();var n=c[r.md.algorithm+"WithRSAEncryption"];if(!n){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=r.md.algorithm,a}r.signatureOid=r.siginfo.algorithmOid=n,r.tbsCertificate=u.getTBSCertificate(r);var s=o.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var i=!1;if(!r.issued(e)){var n=e.issuer,a=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=a.attributes,s}var l=e.md;if(null===l){if(e.signatureOid in c){var f=c[e.signatureOid];switch(f){case"sha1WithRSAEncryption":l=t.md.sha1.create();break;case"md5WithRSAEncryption":l=t.md.md5.create();break;case"sha256WithRSAEncryption":l=t.md.sha256.create();break;case"RSASSA-PSS":l=t.md.sha256.create()}}if(null===l){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var p=e.tbsCertificate||u.getTBSCertificate(e),h=o.toDer(p);l.update(h.getBytes())}if(null!==l){var d;switch(e.signatureOid){case c.sha1WithRSAEncryption:d=void 0;break;case c["RSASSA-PSS"]:var y,g;if(y=c[e.signatureParameters.mgf.hash.algorithmOid],void 0===y||void 0===t.md[y]){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=y,s}if(g=c[e.signatureParameters.mgf.algorithmOid],void 0===g||void 0===t.mgf[g]){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=g,s}if(g=t.mgf[g].create(t.md[y].create()),y=c[e.signatureParameters.hash.algorithmOid],void 0===y||void 0===t.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:y};d=t.pss.create(t.md[y].create(),g,e.signatureParameters.saltLength)}i=r.publicKey.verify(l.digest().getBytes(),e.signature,d)}return i},r.isIssuer=function(t){var e=!1,i=r.issuer,n=t.subject;if(i.hash&&n.hash)e=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){e=!0;for(var a,s,o=0;e&&o<i.attributes.length;++o)a=i.attributes[o],s=n.attributes[o],(a.type!==s.type||a.value!==s.value)&&(e=!1)}return e},r.issued=function(t){return t.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return u.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=c.subjectKeyIdentifier,i=0;i<r.extensions.length;++i){var n=r.extensions[i];if(n.id===e){var a=r.generateSubjectKeyIdentifier().getBytes();return t.util.hexToBytes(n.subjectKeyIdentifier)===a}}return!1},r},u.certificateFromAsn1=function(r,n){var a={},s=[];if(!o.validate(r,p,a,s)){var l=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw l.errors=s,l}if("string"!=typeof a.certSignature){for(var f="\x00",h=0;h<a.certSignature.length;++h)f+=o.toDer(a.certSignature[h]).getBytes();a.certSignature=f}var d=o.derToOid(a.publicKeyOid);if(d!==u.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var y=u.createCertificate();y.version=a.certVersion?a.certVersion.charCodeAt(0):0;var m=t.util.createBuffer(a.certSerialNumber);y.serialNumber=m.toHex(),y.signatureOid=t.asn1.derToOid(a.certSignatureOid),y.signatureParameters=g(y.signatureOid,a.certSignatureParams,!0),y.siginfo.algorithmOid=t.asn1.derToOid(a.certinfoSignatureOid),y.siginfo.parameters=g(y.siginfo.algorithmOid,a.certinfoSignatureParams,!1);var v=t.util.createBuffer(a.certSignature);++v.read,y.signature=v.getBytes();var C=[];if(void 0!==a.certValidity1UTCTime&&C.push(o.utcTimeToDate(a.certValidity1UTCTime)),void 0!==a.certValidity2GeneralizedTime&&C.push(o.generalizedTimeToDate(a.certValidity2GeneralizedTime)),void 0!==a.certValidity3UTCTime&&C.push(o.utcTimeToDate(a.certValidity3UTCTime)),void 0!==a.certValidity4GeneralizedTime&&C.push(o.generalizedTimeToDate(a.certValidity4GeneralizedTime)),C.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(C.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(y.validity.notBefore=C[0],y.validity.notAfter=C[1],y.tbsCertificate=a.tbsCertificate,n){if(y.md=null,y.signatureOid in c){var d=c[y.signatureOid];switch(d){case"sha1WithRSAEncryption":y.md=t.md.sha1.create();break;case"md5WithRSAEncryption":y.md=t.md.md5.create();break;case"sha256WithRSAEncryption":y.md=t.md.sha256.create();break;case"RSASSA-PSS":y.md=t.md.sha256.create()}}if(null===y.md){var l=new Error("Could not compute certificate digest. Unknown signature OID.");throw l.signatureOid=y.signatureOid,l}var E=o.toDer(y.tbsCertificate);y.md.update(E.getBytes())}var S=t.md.sha1.create();y.issuer.getField=function(t){return e(y.issuer,t)},y.issuer.addField=function(t){i([t]),y.issuer.attributes.push(t)},y.issuer.attributes=u.RDNAttributesAsArray(a.certIssuer,S),a.certIssuerUniqueId&&(y.issuer.uniqueId=a.certIssuerUniqueId),y.issuer.hash=S.digest().toHex();var T=t.md.sha1.create();return y.subject.getField=function(t){return e(y.subject,t)},y.subject.addField=function(t){i([t]),y.subject.attributes.push(t)},y.subject.attributes=u.RDNAttributesAsArray(a.certSubject,T),a.certSubjectUniqueId&&(y.subject.uniqueId=a.certSubjectUniqueId),y.subject.hash=T.digest().toHex(),a.certExtensions?y.extensions=u.certificateExtensionsFromAsn1(a.certExtensions):y.extensions=[],y.publicKey=u.publicKeyFromAsn1(a.subjectPublicKeyInfo),y},u.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var i=t.value[r],n=0;n<i.value.length;++n)e.push(u.certificateExtensionFromAsn1(i.value[n]));return e},u.certificateExtensionFromAsn1=function(e){var r={};if(r.id=o.derToOid(e.value[0].value),r.critical=!1,e.value[1].type===o.Type.BOOLEAN?(r.critical=0!==e.value[1].value.charCodeAt(0),r.value=e.value[2].value):r.value=e.value[1].value,r.id in c)if(r.name=c[r.id],"keyUsage"===r.name){var i=o.fromDer(r.value),n=0,a=0;i.value.length>1&&(n=i.value.charCodeAt(1),a=i.value.length>2?i.value.charCodeAt(2):0),r.digitalSignature=128===(128&n),r.nonRepudiation=64===(64&n),r.keyEncipherment=32===(32&n),r.dataEncipherment=16===(16&n),r.keyAgreement=8===(8&n),r.keyCertSign=4===(4&n),r.cRLSign=2===(2&n),r.encipherOnly=1===(1&n),r.decipherOnly=128===(128&a)}else if("basicConstraints"===r.name){var i=o.fromDer(r.value);i.value.length>0&&i.value[0].type===o.Type.BOOLEAN?r.cA=0!==i.value[0].value.charCodeAt(0):r.cA=!1;var s=null;i.value.length>0&&i.value[0].type===o.Type.INTEGER?s=i.value[0].value:i.value.length>1&&(s=i.value[1].value),
null!==s&&(r.pathLenConstraint=o.derToInteger(s))}else if("extKeyUsage"===r.name)for(var i=o.fromDer(r.value),u=0;u<i.value.length;++u){var l=o.derToOid(i.value[u].value);l in c?r[c[l]]=!0:r[l]=!0}else if("nsCertType"===r.name){var i=o.fromDer(r.value),n=0;i.value.length>1&&(n=i.value.charCodeAt(1)),r.client=128===(128&n),r.server=64===(64&n),r.email=32===(32&n),r.objsign=16===(16&n),r.reserved=8===(8&n),r.sslCA=4===(4&n),r.emailCA=2===(2&n),r.objCA=1===(1&n)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){r.altNames=[];for(var f,i=o.fromDer(r.value),p=0;p<i.value.length;++p){f=i.value[p];var h={type:f.type,value:f.value};switch(r.altNames.push(h),f.type){case 1:case 2:case 6:break;case 7:h.ip=t.util.bytesToIP(f.value);break;case 8:h.oid=o.derToOid(f.value)}}}else if("subjectKeyIdentifier"===r.name){var i=o.fromDer(r.value);r.subjectKeyIdentifier=t.util.bytesToHex(i.value)}return r},u.certificationRequestFromAsn1=function(r,n){var a={},s=[];if(!o.validate(r,y,a,s)){var l=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw l.errors=s,l}if("string"!=typeof a.csrSignature){for(var f="\x00",p=0;p<a.csrSignature.length;++p)f+=o.toDer(a.csrSignature[p]).getBytes();a.csrSignature=f}var h=o.derToOid(a.publicKeyOid);if(h!==u.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var d=u.createCertificationRequest();d.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,d.signatureOid=t.asn1.derToOid(a.csrSignatureOid),d.signatureParameters=g(d.signatureOid,a.csrSignatureParams,!0),d.siginfo.algorithmOid=t.asn1.derToOid(a.csrSignatureOid),d.siginfo.parameters=g(d.siginfo.algorithmOid,a.csrSignatureParams,!1);var m=t.util.createBuffer(a.csrSignature);if(++m.read,d.signature=m.getBytes(),d.certificationRequestInfo=a.certificationRequestInfo,n){if(d.md=null,d.signatureOid in c){var h=c[d.signatureOid];switch(h){case"sha1WithRSAEncryption":d.md=t.md.sha1.create();break;case"md5WithRSAEncryption":d.md=t.md.md5.create();break;case"sha256WithRSAEncryption":d.md=t.md.sha256.create();break;case"RSASSA-PSS":d.md=t.md.sha256.create()}}if(null===d.md){var l=new Error("Could not compute certification request digest. Unknown signature OID.");throw l.signatureOid=d.signatureOid,l}var v=o.toDer(d.certificationRequestInfo);d.md.update(v.getBytes())}var C=t.md.sha1.create();return d.subject.getField=function(t){return e(d.subject,t)},d.subject.addField=function(t){i([t]),d.subject.attributes.push(t)},d.subject.attributes=u.RDNAttributesAsArray(a.certificationRequestInfoSubject,C),d.subject.hash=C.digest().toHex(),d.publicKey=u.publicKeyFromAsn1(a.subjectPublicKeyInfo),d.getAttribute=function(t){return e(d,t)},d.addAttribute=function(t){i([t]),d.attributes.push(t)},d.attributes=u.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),d},u.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(t){return e(r.subject,t)},r.subject.addField=function(t){i([t]),r.subject.attributes.push(t)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(t){return e(r,t)},r.addAttribute=function(t){i([t]),r.attributes.push(t)},r.md=null,r.setSubject=function(t){i(t),r.subject.attributes=t,r.subject.hash=null},r.setAttributes=function(t){i(t),r.attributes=t},r.sign=function(e,i){r.md=i||t.md.sha1.create();var n=c[r.md.algorithm+"WithRSAEncryption"];if(!n){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=r.md.algorithm,a}r.signatureOid=r.siginfo.algorithmOid=n,r.certificationRequestInfo=u.getCertificationRequestInfo(r);var s=o.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,i=r.md;if(null===i){if(r.signatureOid in c){var n=c[r.signatureOid];switch(n){case"sha1WithRSAEncryption":i=t.md.sha1.create();break;case"md5WithRSAEncryption":i=t.md.md5.create();break;case"sha256WithRSAEncryption":i=t.md.sha256.create();break;case"RSASSA-PSS":i=t.md.sha256.create()}}if(null===i){var a=new Error("Could not compute certification request digest. Unknown signature OID.");throw a.signatureOid=r.signatureOid,a}var s=r.certificationRequestInfo||u.getCertificationRequestInfo(r),l=o.toDer(s);i.update(l.getBytes())}if(null!==i){var f;switch(r.signatureOid){case c.sha1WithRSAEncryption:break;case c["RSASSA-PSS"]:var p,h;if(p=c[r.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===t.md[p]){var a=new Error("Unsupported MGF hash function.");throw a.oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=p,a}if(h=c[r.signatureParameters.mgf.algorithmOid],void 0===h||void 0===t.mgf[h]){var a=new Error("Unsupported MGF function.");throw a.oid=r.signatureParameters.mgf.algorithmOid,a.name=h,a}if(h=t.mgf[h].create(t.md[p].create()),p=c[r.signatureParameters.hash.algorithmOid],void 0===p||void 0===t.md[p]){var a=new Error("Unsupported RSASSA-PSS hash function.");throw a.oid=r.signatureParameters.hash.algorithmOid,a.name=p,a}f=t.pss.create(t.md[p].create(),h,r.signatureParameters.saltLength)}e=r.publicKey.verify(i.digest().getBytes(),r.signature,f)}return e},r},u.getTBSCertificate=function(e){var i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(e.version).getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,t.util.hexToBytes(e.serialNumber)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.siginfo.algorithmOid).getBytes()),a(e.siginfo.algorithmOid,e.siginfo.parameters)]),r(e.issuer),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(e.validity.notBefore)),o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(e.validity.notAfter))]),r(e.subject),u.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&i.value.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&i.value.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&i.value.push(u.certificateExtensionsToAsn1(e.extensions)),i},u.getCertificationRequestInfo=function(t){var e=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.version).getBytes()),r(t.subject),u.publicKeyToAsn1(t.publicKey),s(t)]);return e},u.distinguishedNameToAsn1=function(t){return r(t)},u.certificateToAsn1=function(t){var e=t.tbsCertificate||u.getTBSCertificate(t);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[e,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.signatureOid).getBytes()),a(t.signatureOid,t.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},u.certificateExtensionsToAsn1=function(t){var e=o.create(o.Class.CONTEXT_SPECIFIC,3,!0,[]),r=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);e.value.push(r);for(var i=0;i<t.length;++i)r.value.push(u.certificateExtensionToAsn1(t[i]));return e},u.certificateExtensionToAsn1=function(t){var e=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);e.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.id).getBytes())),t.critical&&e.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return"string"!=typeof t.value&&(r=o.toDer(r).getBytes()),e.value.push(o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,r)),e},u.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||u.getCertificationRequestInfo(t);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[e,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.signatureOid).getBytes()),a(t.signatureOid,t.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},u.createCaStore=function(e){function i(e){if(!e.hash){var i=t.md.sha1.create();e.attributes=u.RDNAttributesAsArray(r(e),i),e.hash=i.digest().toHex()}return n.certs[e.hash]||null}var n={certs:{}};if(n.getIssuer=function(t){var e=i(t.issuer);return e},n.addCertificate=function(e){if("string"==typeof e&&(e=t.pki.certificateFromPem(e)),!e.subject.hash){var i=t.md.sha1.create();e.subject.attributes=u.RDNAttributesAsArray(r(e.subject),i),e.subject.hash=i.digest().toHex()}if(e.subject.hash in n.certs){var a=n.certs[e.subject.hash];t.util.isArray(a)||(a=[a]),a.push(e)}else n.certs[e.subject.hash]=e},n.hasCertificate=function(e){var r=i(e.subject);if(!r)return!1;t.util.isArray(r)||(r=[r]);for(var n=o.toDer(u.certificateToAsn1(e)).getBytes(),a=0;a<r.length;++a){var s=o.toDer(u.certificateToAsn1(r[a])).getBytes();if(n===s)return!0}return!1},e)for(var a=0;a<e.length;++a){var s=e[a];n.addCertificate(s)}return n},u.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},u.verifyCertificateChain=function(e,r,i){r=r.slice(0);var n=r.slice(0),a=new Date,s=!0,o=null,c=0;do{var l=r.shift(),f=null,p=!1;if((a<l.validity.notBefore||a>l.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:u.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:a}),null===o){if(f=r[0]||e.getIssuer(l),null===f&&l.isIssuer(l)&&(p=!0,f=l),f){var h=f;t.util.isArray(h)||(h=[h]);for(var d=!1;!d&&h.length>0;){f=h.shift();try{d=f.verify(l)}catch(y){}}d||(o={message:"Certificate signature is invalid.",error:u.certificateError.bad_certificate})}null!==o||f&&!p||e.hasCertificate(l)||(o={message:"Certificate is not trusted.",error:u.certificateError.unknown_ca})}if(null===o&&f&&!l.isIssuer(f)&&(o={message:"Certificate issuer is invalid.",error:u.certificateError.bad_certificate}),null===o)for(var g={keyUsage:!0,basicConstraints:!0},m=0;null===o&&m<l.extensions.length;++m){var v=l.extensions[m];!v.critical||v.name in g||(o={message:"Certificate has an unsupported critical extension.",error:u.certificateError.unsupported_certificate})}if(null===o&&(!s||0===r.length&&(!f||p))){var C=l.getExtension("basicConstraints"),E=l.getExtension("keyUsage");if(null!==E&&(E.keyCertSign&&null!==C||(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:u.certificateError.bad_certificate})),null!==o||null===C||C.cA||(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:u.certificateError.bad_certificate}),null===o&&null!==E&&"pathLenConstraint"in C){var S=c-1;S>C.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:u.certificateError.bad_certificate})}}var T=null===o?!0:o.error,I=i?i(T,c,n):T;if(I!==!0)throw T===!0&&(o={message:"The application rejected the certificate.",error:u.certificateError.bad_certificate}),(I||0===I)&&("object"!=typeof I||t.util.isArray(I)?"string"==typeof I&&(o.error=I):(I.message&&(o.message=I.message),I.error&&(o.error=I.error))),o;o=null,s=!1,++c}while(r.length>0);return!0}}var i="x509";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r.pki}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./md","./oids","./pem","./rsa","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(t,e,r,i){for(var n=[],a=0;a<t.length;a++)for(var s=0;s<t[a].safeBags.length;s++){var o=t[a].safeBags[s];(void 0===i||o.type===i)&&(null!==e?void 0!==o.attributes[e]&&o.attributes[e].indexOf(r)>=0&&n.push(o):n.push(o))}return n}function r(e){if(e.composed||e.constructed){for(var r=t.util.createBuffer(),i=0;i<e.value.length;++i)r.putBytes(e.value[i].value);e.composed=e.constructed=!1,e.value=r.getBytes()}return e}function i(t,e,i,s){if(e=o.fromDer(e,i),e.tagClass!==o.Class.UNIVERSAL||e.type!==o.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var c=0;c<e.value.length;c++){var f=e.value[c],p={},h=[];if(!o.validate(f,l,p,h)){var d=new Error("Cannot read ContentInfo.");throw d.errors=h,d}var y={encrypted:!1},g=null,m=p.content.value[0];switch(o.derToOid(p.contentType)){case u.oids.data:if(m.tagClass!==o.Class.UNIVERSAL||m.type!==o.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");g=r(m).value;break;case u.oids.encryptedData:g=n(m,s),y.encrypted=!0;break;default:var d=new Error("Unsupported PKCS#12 contentType.");throw d.contentType=o.derToOid(p.contentType),d}y.safeBags=a(g,i,s),t.safeContents.push(y)}}function n(e,i){var n={},a=[];if(!o.validate(e,t.pkcs7.asn1.encryptedDataValidator,n,a)){var s=new Error("Cannot read EncryptedContentInfo.");throw s.errors=a,s}var c=o.derToOid(n.contentType);if(c!==u.oids.data){var s=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw s.oid=c,s}c=o.derToOid(n.encAlgorithm);var l=u.pbe.getCipher(c,n.encParameter,i),f=r(n.encryptedContentAsn1),p=t.util.createBuffer(f.value);if(l.update(p),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function a(t,e,r){if(!e&&0===t.length)return[];if(t=o.fromDer(t,e),t.tagClass!==o.Class.UNIVERSAL||t.type!==o.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var i=[],n=0;n<t.value.length;n++){var a=t.value[n],c={},l=[];if(!o.validate(a,p,c,l)){var f=new Error("Cannot read SafeBag.");throw f.errors=l,f}var h={type:o.derToOid(c.bagId),attributes:s(c.bagAttributes)};i.push(h);var y,g,m=c.bagValue.value[0];switch(h.type){case u.oids.pkcs8ShroudedKeyBag:if(m=u.decryptPrivateKeyInfo(m,r),null===m)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case u.oids.keyBag:try{h.key=u.privateKeyFromAsn1(m)}catch(v){h.key=null,h.asn1=m}continue;case u.oids.certBag:y=d,g=function(){if(o.derToOid(c.certId)!==u.oids.x509Certificate){var t=new Error("Unsupported certificate type, only X.509 supported.");throw t.oid=o.derToOid(c.certId),t}var r=o.fromDer(c.cert,e);try{h.cert=u.certificateFromAsn1(r,!0)}catch(i){h.cert=null,h.asn1=r}};break;default:var f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=h.type,f}if(void 0!==y&&!o.validate(m,y,c,l)){var f=new Error("Cannot read PKCS#12 "+y.name);throw f.errors=l,f}g()}return i}function s(t){var e={};if(void 0!==t)for(var r=0;r<t.length;++r){var i={},n=[];if(!o.validate(t[r],h,i,n)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=n,a}var s=o.derToOid(i.oid);if(void 0!==u.oids[s]){e[u.oids[s]]=[];for(var c=0;c<i.values.length;++c)e[u.oids[s]].push(i.values[c].value)}}return e}var o=t.asn1,u=t.pki,c=t.pkcs12=t.pkcs12||{},l={name:"ContentInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},f={name:"PFX",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"version"},l,{name:"PFX.macData",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},p={name:"SafeBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},h={name:"Attribute",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,capture:"values"}]},d={name:"CertBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:o.Class.UNIVERSAL,type:o.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};c.pkcs12FromAsn1=function(n,a,s){"string"==typeof a?(s=a,a=!0):void 0===a&&(a=!0);var l={},p=[];if(!o.validate(n,f,l,p)){var h=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw h.errors=h,h}var d={version:l.version.charCodeAt(0),safeContents:[],getBags:function(r){var i,n={};return"localKeyId"in r?i=r.localKeyId:"localKeyIdHex"in r&&(i=t.util.hexToBytes(r.localKeyIdHex)),void 0===i&&!("friendlyName"in r)&&"bagType"in r&&(n[r.bagType]=e(d.safeContents,null,null,r.bagType)),void 0!==i&&(n.localKeyId=e(d.safeContents,"localKeyId",i,r.bagType)),"friendlyName"in r&&(n.friendlyName=e(d.safeContents,"friendlyName",r.friendlyName,r.bagType)),n},getBagsByFriendlyName:function(t,r){return e(d.safeContents,"friendlyName",t,r)},getBagsByLocalKeyId:function(t,r){return e(d.safeContents,"localKeyId",t,r)}};if(3!==l.version.charCodeAt(0)){var h=new Error("PKCS#12 PFX of version other than 3 not supported.");throw h.version=l.version.charCodeAt(0),h}if(o.derToOid(l.contentType)!==u.oids.data){var h=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw h.oid=o.derToOid(l.contentType),h}var y=l.content.value[0];if(y.tagClass!==o.Class.UNIVERSAL||y.type!==o.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(y=r(y),l.mac){var g=null,m=0,v=o.derToOid(l.macAlgorithm);switch(v){case u.oids.sha1:g=t.md.sha1.create(),m=20;break;case u.oids.sha256:g=t.md.sha256.create(),m=32;break;case u.oids.sha384:g=t.md.sha384.create(),m=48;break;case u.oids.sha512:g=t.md.sha512.create(),m=64;break;case u.oids.md5:g=t.md.md5.create(),m=16}if(null===g)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+v);var C=new t.util.ByteBuffer(l.macSalt),E="macIterations"in l?parseInt(t.util.bytesToHex(l.macIterations),16):1,S=c.generateKey(s,C,3,E,m,g),T=t.hmac.create();T.start(g,S),T.update(y.value);var I=T.getMac();if(I.getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return i(d,y.value,a,s),d},c.toPkcs12Asn1=function(e,r,i,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var a,s=n.localKeyId;if(null!==s)s=t.util.hexToBytes(s);else if(n.generateLocalKeyId)if(r){var l=t.util.isArray(r)?r[0]:r;"string"==typeof l&&(l=u.certificateFromPem(l));var f=t.md.sha1.create();f.update(o.toDer(u.certificateToAsn1(l)).getBytes()),s=f.digest().getBytes()}else s=t.random.getBytes(20);var p=[];null!==s&&p.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.localKeyId).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,s)])])),"friendlyName"in n&&p.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.friendlyName).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.BMPSTRING,!1,n.friendlyName)])])),p.length>0&&(a=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,p));var h=[],d=[];null!==r&&(d=t.util.isArray(r)?r:[r]);for(var y=[],g=0;g<d.length;++g){r=d[g],"string"==typeof r&&(r=u.certificateFromPem(r));var m=0===g?a:void 0,v=u.certificateToAsn1(r),C=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.certBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.x509Certificate).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(v).getBytes())])])]),m]);y.push(C)}if(y.length>0){var E=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,y),S=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(E).getBytes())])]);h.push(S)}var T=null;if(null!==e){var I=u.wrapRsaPrivateKey(u.privateKeyToAsn1(e));T=null===i?o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.keyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[I]),a]):o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.pkcs8ShroudedKeyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[u.encryptPrivateKeyInfo(I,i,n)]),a]);var A=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[T]),b=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(A).getBytes())])]);h.push(b)}var B,N=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,h);if(n.useMac){var f=t.md.sha1.create(),R=new t.util.ByteBuffer(t.random.getBytes(n.saltSize)),w=n.count,e=c.generateKey(i,R,3,w,20),U=t.hmac.create();U.start(f,e),U.update(o.toDer(N).getBytes());var L=U.getMac();B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.sha1).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,L.getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,R.getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(w).getBytes())])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(3).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(N).getBytes())])]),B])},c.generateKey=t.pbe.generatePkcs12Key}var i="pkcs12";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./random","./rsa","./sha1","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){var e=t.asn1,r=t.pki=t.pki||{};r.pemToDer=function(e){var r=t.pem.decode(e)[0];if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return t.util.createBuffer(r.body)},r.privateKeyFromPem=function(i){var n=t.pem.decode(i)[0];if("PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=n.type,a}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var s=e.fromDer(n.body);return r.privateKeyFromAsn1(s)},r.privateKeyToPem=function(i,n){var a={type:"RSA PRIVATE KEY",body:e.toDer(r.privateKeyToAsn1(i)).getBytes()};return t.pem.encode(a,{maxline:n})},r.privateKeyInfoToPem=function(r,i){var n={type:"PRIVATE KEY",body:e.toDer(r).getBytes()};return t.pem.encode(n,{maxline:i})}}var i="pki";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pem","./pbkdf2","./rsa","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function t(t){function e(e){var r={},i=[];if(!f.validate(e,p.asn1.recipientInfoValidator,r,i)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=i,n}return{version:r.version.charCodeAt(0),issuer:t.pki.RDNAttributesAsArray(r.issuer),serialNumber:t.util.createBuffer(r.serial).toHex(),encryptedContent:{algorithm:f.derToOid(r.encAlgorithm),parameter:r.encParameter.value,content:r.encKey}}}function r(e){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(e.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:e.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,t.util.hexToBytes(e.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.encryptedContent.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function i(t){for(var r=[],i=0;i<t.length;++i)r.push(e(t[i]));return r}function n(t){for(var e=[],i=0;i<t.length;++i)e.push(r(t[i]));return e}function a(e){var r=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(e.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[t.pki.distinguishedNameToAsn1({attributes:e.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,t.util.hexToBytes(e.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.digestAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&r.value.push(e.authenticatedAttributesAsn1),r.value.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.signatureAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])),r.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var i=f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<e.unauthenticatedAttributes.length;++n){var a=e.unauthenticatedAttributes[n];i.values.push(o(a))}r.value.push(i)}return r}function s(t){for(var e=[],r=0;r<t.length;++r)e.push(a(t[r]));return e}function o(e){var r;if(e.type===t.pki.oids.contentType)r=f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.value).getBytes());else if(e.type===t.pki.oids.messageDigest)r=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===t.pki.oids.signingTime){var i=new Date("Jan 1, 1950 00:00:00Z"),n=new Date("Jan 1, 2050 00:00:00Z"),a=e.value;if("string"==typeof a){var s=Date.parse(a);a=isNaN(s)?13===a.length?f.utcTimeToDate(a):f.generalizedTimeToDate(a):new Date(s)}r=a>=i&&n>a?f.create(f.Class.UNIVERSAL,f.Type.UTCTIME,!1,f.dateToUtcTime(a)):f.create(f.Class.UNIVERSAL,f.Type.GENERALIZEDTIME,!1,f.dateToGeneralizedTime(a))}return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.type).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[r])])}function u(e){return[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.pki.oids.data).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e.parameter.getBytes())]),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,e.content.getBytes())])]}function c(e,r,i){var n={},a=[];if(!f.validate(r,i,n,a)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=f.derToOid(n.contentType);if(o!==t.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var u="";if(t.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=n.encryptedContent[c].value}else u=n.encryptedContent;e.encryptedContent={algorithm:f.derToOid(n.encAlgorithm),parameter:t.util.createBuffer(n.encParameter.value),content:t.util.createBuffer(u)}}if(n.content){var u="";if(t.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==f.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=n.content[c].value}else u=n.content;e.content=t.util.createBuffer(u)}return e.version=n.version.charCodeAt(0),e.rawCapture=n,n}function l(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var r;switch(e.encryptedContent.algorithm){case t.pki.oids["aes128-CBC"]:case t.pki.oids["aes192-CBC"]:case t.pki.oids["aes256-CBC"]:r=t.aes.createDecryptionCipher(e.encryptedContent.key);break;case t.pki.oids.desCBC:case t.pki.oids["des-EDE3-CBC"]:
  r=t.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(r.start(e.encryptedContent.parameter),r.update(e.encryptedContent.content),!r.finish())throw new Error("Symmetric decryption failed.");e.content=r.output}}var f=t.asn1,p=t.pkcs7=t.pkcs7||{};p.messageFromPem=function(e){var r=t.pem.decode(e)[0];if("PKCS7"!==r.type){var i=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw i.headerType=r.type,i}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=f.fromDer(r.body);return p.messageFromAsn1(n)},p.messageToPem=function(e,r){var i={type:"PKCS7",body:f.toDer(e.toAsn1()).getBytes()};return t.pem.encode(i,{maxline:r})},p.messageFromAsn1=function(e){var r={},i=[];if(!f.validate(e,p.asn1.contentInfoValidator,r,i)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=i,n}var a,s=f.derToOid(r.contentType);switch(s){case t.pki.oids.envelopedData:a=p.createEnvelopedData();break;case t.pki.oids.encryptedData:a=p.createEncryptedData();break;case t.pki.oids.signedData:a=p.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return a.fromAsn1(r.content.value[0]),a},p.createSignedData=function(){function e(){for(var e={},r=0;r<i.signers.length;++r){var n=i.signers[r],a=n.digestAlgorithm;a in e||(e[a]=t.md[t.pki.oids[a]].create()),0===n.authenticatedAttributes.length?n.md=e[a]:n.md=t.md[t.pki.oids[a]].create()}i.digestAlgorithmIdentifiers=[];for(var a in e)i.digestAlgorithmIdentifiers.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));return e}function r(e){if(i.contentInfo.value.length<2)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var r=f.derToOid(i.contentInfo.value[0].value),n=i.contentInfo.value[1];n=n.value[0];var a=f.toDer(n);a.getByte(),f.getBerValueLength(a),a=a.getBytes();for(var u in e)e[u].start().update(a);for(var c=new Date,l=0;l<i.signers.length;++l){var p=i.signers[l];if(0===p.authenticatedAttributes.length){if(r!==t.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{p.authenticatedAttributesAsn1=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[]),d=0;d<p.authenticatedAttributes.length;++d){var y=p.authenticatedAttributes[d];y.type===t.pki.oids.messageDigest?y.value=e[p.digestAlgorithm].digest():y.type===t.pki.oids.signingTime&&(y.value||(y.value=c)),h.value.push(o(y)),p.authenticatedAttributesAsn1.value.push(o(y))}a=f.toDer(h).getBytes(),p.md.start().update(a)}p.signature=p.key.sign(p.md,"RSASSA-PKCS1-V1_5")}i.signerInfos=s(i.signers)}var i=null;return i={type:t.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(e){c(i,e,p.asn1.signedDataValidator),i.certificates=[],i.crls=[],i.digestAlgorithmIdentifiers=[],i.contentInfo=null,i.signerInfos=[];for(var r=i.rawCapture.certificates.value,n=0;n<r.length;++n)i.certificates.push(t.pki.certificateFromAsn1(r[n]))},toAsn1:function(){i.contentInfo||i.sign();for(var e=[],r=0;r<i.certificates.length;++r)e.push(t.pki.certificateToAsn1(i.certificates[r]));var n=[],a=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(i.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,i.digestAlgorithmIdentifiers),i.contentInfo])]);return e.length>0&&a.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,e)),n.length>0&&a.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,1,!0,n)),a.value[0].value.push(f.create(f.Class.UNIVERSAL,f.Type.SET,!0,i.signerInfos)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(i.type).getBytes()),a])},addSigner:function(e){var r=e.issuer,n=e.serialNumber;if(e.certificate){var a=e.certificate;"string"==typeof a&&(a=t.pki.certificateFromPem(a)),r=a.issuer.attributes,n=a.serialNumber}var s=e.key;if(!s)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof s&&(s=t.pki.privateKeyFromPem(s));var o=e.digestAlgorithm||t.pki.oids.sha1;switch(o){case t.pki.oids.sha1:case t.pki.oids.sha256:case t.pki.oids.sha384:case t.pki.oids.sha512:case t.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var u=e.authenticatedAttributes||[];if(u.length>0){for(var c=!1,l=!1,f=0;f<u.length;++f){var p=u[f];if(c||p.type!==t.pki.oids.contentType){if(l||p.type!==t.pki.oids.messageDigest);else if(l=!0,c)break}else if(c=!0,l)break}if(!c||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}i.signers.push({key:s,version:1,issuer:r,serialNumber:n,digestAlgorithm:o,signatureAlgorithm:t.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(){if(("object"!=typeof i.content||null===i.contentInfo)&&(i.contentInfo=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(t.pki.oids.data).getBytes())]),"content"in i)){var n;i.content instanceof t.util.ByteBuffer?n=i.content.bytes():"string"==typeof i.content&&(n=t.util.encodeUtf8(i.content)),i.contentInfo.value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,n)]))}if(0!==i.signers.length){var a=e();r(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(e){"string"==typeof e&&(e=t.pki.certificateFromPem(e)),i.certificates.push(e)},addCertificateRevokationList:function(t){throw new Error("PKCS#7 CRL support not yet implemented.")}}},p.createEncryptedData=function(){var e=null;return e={type:t.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(t){c(e,t,p.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),l(e)}}},p.createEnvelopedData=function(){var e=null;return e={type:t.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:t.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=c(e,t,p.asn1.envelopedDataValidator);e.recipients=i(r.recipientInfos.value)},toAsn1:function(){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(e.type).getBytes()),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(e.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,n(e.recipients)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,u(e.encryptedContent))])])])},findRecipient:function(t){for(var r=t.issuer.attributes,i=0;i<e.recipients.length;++i){var n=e.recipients[i],a=n.issuer;if(n.serialNumber===t.serialNumber&&a.length===r.length){for(var s=!0,o=0;o<r.length;++o)if(a[o].type!==r[o].type||a[o].value!==r[o].value){s=!1;break}if(s)return n}}return null},decrypt:function(r,i){if(void 0===e.encryptedContent.key&&void 0!==r&&void 0!==i)switch(r.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:case t.pki.oids.desCBC:var n=i.decrypt(r.encryptedContent.content);e.encryptedContent.key=t.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+r.encryptedContent.algorithm)}l(e)},addRecipient:function(r){e.recipients.push({version:0,issuer:r.issuer.attributes,serialNumber:r.serialNumber,encryptedContent:{algorithm:t.pki.oids.rsaEncryption,key:r.publicKey}})},encrypt:function(r,i){if(void 0===e.encryptedContent.content){i=i||e.encryptedContent.algorithm,r=r||e.encryptedContent.key;var n,a,s;switch(i){case t.pki.oids["aes128-CBC"]:n=16,a=16,s=t.aes.createEncryptionCipher;break;case t.pki.oids["aes192-CBC"]:n=24,a=16,s=t.aes.createEncryptionCipher;break;case t.pki.oids["aes256-CBC"]:n=32,a=16,s=t.aes.createEncryptionCipher;break;case t.pki.oids["des-EDE3-CBC"]:n=24,a=8,s=t.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+i)}if(void 0===r)r=t.util.createBuffer(t.random.getBytes(n));else if(r.length()!=n)throw new Error("Symmetric key has wrong length; got "+r.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=i,e.encryptedContent.key=r,e.encryptedContent.parameter=t.util.createBuffer(t.random.getBytes(a));var o=s(r);if(o.start(e.encryptedContent.parameter.copy()),o.update(e.content),!o.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=o.output}for(var u=0;u<e.recipients.length;++u){var c=e.recipients[u];if(void 0===c.encryptedContent.content)switch(c.encryptedContent.algorithm){case t.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}}}}var i="pkcs7";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),t(forge);var n=!0;r=function(t,r){r(e,module)}}var a,s=function(e,r){r.exports=function(r){var n=a.map(function(t){return e(t)}).concat(t);if(r=r||{},r.defined=r.defined||{},r.defined[i])return r[i];r.defined[i]=!0;for(var s=0;s<n.length;++s)n[s](r);return r[i]}},o=r;(r=function(t,e){return a="string"==typeof t?e.slice(2):t.slice(2),n?o.apply(null,Array.prototype.slice.call(arguments,0)):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var t="forge";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var i=!0;r=function(t,r){r(e,module)}}var n,a=function(e,r){r.exports=function(r){var i=n.map(function(t){return e(t)});if(r=r||{},r.defined=r.defined||{},r.defined[t])return r[t];r.defined[t]=!0;for(var a=0;a<i.length;++a)i[a](r);return r},r.exports.disableNativeCode=!1,r.exports(r.exports)},s=r;(r=function(t,e){return n="string"==typeof t?e.slice(2):t.slice(2),i?s.apply(null,Array.prototype.slice.call(arguments,0)):(r=s,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./asn1","./hmac","./md","./pbkdf2","./pem","./pkcs1","./pki","./prime","./prng","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})}(),e("js/forge")}module.exports=initForge;